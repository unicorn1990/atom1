<!DOCTYPE html>
<!-- saved from url=(0038)https://www.jianshu.com/p/fd61e8f4049e -->
<html><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">

  <!-- Start of Baidu Transcode -->
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta name="applicable-device" content="pc,mobile">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <meta name="mobile-agent" content="format=html5;url=https://www.jianshu.com/p/fd61e8f4049e">
  <!-- End of Baidu Transcode -->

    <meta name="description" content="前言 总结 Android WebView 常用的相关知识点，令包含以下干货内容分析：Js注入漏洞、WebView 遇到的坑、JsBridge 原理以及框架使用(JsBridge,DSBridge-Android)、缓存机制应用、性能优化、腾讯开源框架 VasSonic (之后会进行代码分析)。 目录 一、简介 这部分主要介绍下 WebView，WebView 是一个用来显示 Web 网页的...">

  <meta name="360-site-verification" content="604a14b53c6b871206001285921e81d8">
  <meta property="wb:webmaster" content="294ec9de89e7fadb">
  <meta property="qc:admins" content="104102651453316562112116375">
  <meta property="qc:admins" content="11635613706305617">
  <meta property="qc:admins" content="1163561616621163056375">
  <meta name="google-site-verification" content="cV4-qkUJZR6gmFeajx_UyPe47GW9vY6cnCrYtCHYNh4">
  <meta name="google-site-verification" content="HF7lfF8YEGs1qtCE-kPml8Z469e2RHhGajy6JPVy5XI">
  <meta http-equiv="mobile-agent" content="format=html5; url=https://www.jianshu.com/p/fd61e8f4049e">

  <!-- Apple -->
  <meta name="apple-mobile-web-app-title" content="简书">

    <!--  Meta for Smart App Banner -->
  <meta name="apple-itunes-app" content="app-id=888237539, app-argument=jianshu://notes/18978328">
  <!-- End -->

  <!--  Meta for Twitter Card -->
  <meta content="summary" property="twitter:card">
  <meta content="@jianshucom" property="twitter:site">
  <meta content="Android WebView 全面干货指南" property="twitter:title">
  <meta content="前言 总结 Android WebView 常用的相关知识点，令包含以下干货内容分析：Js注入漏洞、WebView 遇到的坑、JsBridge 原理以及框架使用(JsBrid..." property="twitter:description">
  <meta content="https://www.jianshu.com/p/fd61e8f4049e" property="twitter:url">
  <!-- End -->

  <!--  Meta for OpenGraph -->
  <meta property="fb:app_id" content="865829053512461">
  <meta property="og:site_name" content="简书">
  <meta property="og:title" content="Android WebView 全面干货指南">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://www.jianshu.com/p/fd61e8f4049e">
  <meta property="og:description" content="前言 总结 Android WebView 常用的相关知识点，令包含以下干货内容分析：Js注入漏洞、WebView 遇到的坑、JsBridge 原理以及框架使用(JsBridge,DSBridg...">
  <!-- End -->

  <!--  Meta for Facebook Applinks -->
  <meta property="al:ios:url" content="jianshu://notes/18978328">
  <meta property="al:ios:app_store_id" content="888237539">
  <meta property="al:ios:app_name" content="简书">

  <meta property="al:android:url" content="jianshu://notes/18978328">
  <meta property="al:android:package" content="com.jianshu.haruki">
  <meta property="al:android:app_name" content="简书">
  <!-- End -->


    <title>Android WebView 全面干货指南 - 简书</title>

  <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="BrUfE0wJtVVTdICrYwAOGmDLk1IxReiWpJmk4KCq4HWn067VHratyW1qZyjxSshplTBV4FeVvSOchWnRbRT/uw==">

  <link rel="stylesheet" media="all" href="./Android WebView 全面干货指南 - 简书_files/web-221ec98db5f8f985b66f.css">
  
  <link rel="stylesheet" media="all" href="./Android WebView 全面干货指南 - 简书_files/entry-a9201972e0c141d2fe27.css">

  <link href="https://cdn2.jianshu.io/assets/favicons/favicon-e743bfb1821442341c3ab15bdbe804f7ad97676bd07a770ccc9483473aa76f06.ico" rel="shortcut icon" type="image/x-icon">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/57-a6f1f1ee62ace44f6dc2f6a08575abd3c3b163288881c78dd8d75247682a4b27.png" sizes="57x57">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/72-fb9834bcfce738fd7b9c5e31363e79443e09a81a8e931170b58bc815387c1562.png" sizes="72x72">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/76-49d88e539ff2489475d603994988d871219141ecaa0b1a7a9a1914f4fe3182d6.png" sizes="76x76">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/114-24252fe693524ed3a9d0905e49bff3cbd0228f25a320aa09053c2ebb4955de97.png" sizes="114x114">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/120-1bb7371f5e87f93ce780a5f1a05ff1b176828ee0d1d130e768575918a2e05834.png" sizes="120x120">
      <link rel="apple-touch-icon-precomposed" href="https://cdn2.jianshu.io/assets/apple-touch-icons/152-bf209460fc1c17bfd3e2b84c8e758bc11ca3e570fd411c3bbd84149b97453b99.png" sizes="152x152">

  <!-- Start of 访问统计 -->
    <script src="./Android WebView 全面干货指南 - 简书_files/push.js"></script><script src="./Android WebView 全面干货指南 - 简书_files/hm.js"></script><script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?0c0e9d9b1e7d617b3e6842e85b9fb068";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

  <!-- End of 访问统计 -->
<style type="text/css">fieldset[disabled] .multiselect {
  pointer-events: none;
}

.multiselect__spinner {
  position: absolute;
  right: 1px;
  top: 1px;
  width: 48px;
  height: 35px;
  background: #fff;
  display: block;
}

.multiselect__spinner:after,
.multiselect__spinner:before {
  position: absolute;
  content: "";
  top: 50%;
  left: 50%;
  margin: -8px 0 0 -8px;
  width: 16px;
  height: 16px;
  border-radius: 100%;
  border-color: #41b883 transparent transparent;
  border-style: solid;
  border-width: 2px;
  box-shadow: 0 0 0 1px transparent;
}

.multiselect__spinner:before {
  animation: a 2.4s cubic-bezier(.41,.26,.2,.62);
  animation-iteration-count: infinite;
}

.multiselect__spinner:after {
  animation: a 2.4s cubic-bezier(.51,.09,.21,.8);
  animation-iteration-count: infinite;
}

.multiselect__loading-enter-active,
.multiselect__loading-leave-active {
  transition: opacity .4s ease-in-out;
  opacity: 1;
}

.multiselect__loading-enter,
.multiselect__loading-leave-active {
  opacity: 0;
}

.multiselect,
.multiselect__input,
.multiselect__single {
  font-family: inherit;
  font-size: 14px;
  -ms-touch-action: manipulation;
  touch-action: manipulation;
}

.multiselect {
  box-sizing: content-box;
  display: block;
  position: relative;
  width: 100%;
  min-height: 40px;
  text-align: left;
  color: #35495e;
}

.multiselect * {
  box-sizing: border-box;
}

.multiselect:focus {
  outline: none;
}

.multiselect--disabled {
  opacity: .6;
}

.multiselect--active {
  z-index: 1;
}

.multiselect--active:not(.multiselect--above) .multiselect__current,
.multiselect--active:not(.multiselect--above) .multiselect__input,
.multiselect--active:not(.multiselect--above) .multiselect__tags {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

.multiselect--active .multiselect__select {
  transform: rotate(180deg);
}

.multiselect--above.multiselect--active .multiselect__current,
.multiselect--above.multiselect--active .multiselect__input,
.multiselect--above.multiselect--active .multiselect__tags {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
}

.multiselect__input,
.multiselect__single {
  position: relative;
  display: inline-block;
  min-height: 20px;
  line-height: 20px;
  border: none;
  border-radius: 5px;
  background: #fff;
  padding: 0 0 0 5px;
  width: 100%;
  transition: border .1s ease;
  box-sizing: border-box;
  margin-bottom: 8px;
  vertical-align: top;
}

.multiselect__tag~.multiselect__input,
.multiselect__tag~.multiselect__single {
  width: auto;
}

.multiselect__input:hover,
.multiselect__single:hover {
  border-color: #cfcfcf;
}

.multiselect__input:focus,
.multiselect__single:focus {
  border-color: #a8a8a8;
  outline: none;
}

.multiselect__single {
  padding-left: 6px;
  margin-bottom: 8px;
}

.multiselect__tags-wrap {
  display: inline;
}

.multiselect__tags {
  min-height: 40px;
  display: block;
  padding: 8px 40px 0 8px;
  border-radius: 5px;
  border: 1px solid #e8e8e8;
  background: #fff;
}

.multiselect__tag {
  position: relative;
  display: inline-block;
  padding: 4px 26px 4px 10px;
  border-radius: 5px;
  margin-right: 10px;
  color: #fff;
  line-height: 1;
  background: #41b883;
  margin-bottom: 5px;
  white-space: nowrap;
  overflow: hidden;
  max-width: 100%;
  text-overflow: ellipsis;
}

.multiselect__tag-icon {
  cursor: pointer;
  margin-left: 7px;
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  font-weight: 700;
  font-style: normal;
  width: 22px;
  text-align: center;
  line-height: 22px;
  transition: all .2s ease;
  border-radius: 5px;
}

.multiselect__tag-icon:after {
  content: "\D7";
  color: #266d4d;
  font-size: 14px;
}

.multiselect__tag-icon:focus,
.multiselect__tag-icon:hover {
  background: #369a6e;
}

.multiselect__tag-icon:focus:after,
.multiselect__tag-icon:hover:after {
  color: #fff;
}

.multiselect__current {
  min-height: 40px;
  overflow: hidden;
  padding: 8px 12px 0;
  padding-right: 30px;
  white-space: nowrap;
  border-radius: 5px;
  border: 1px solid #e8e8e8;
}

.multiselect__current,
.multiselect__select {
  line-height: 16px;
  box-sizing: border-box;
  display: block;
  margin: 0;
  text-decoration: none;
  cursor: pointer;
}

.multiselect__select {
  position: absolute;
  width: 40px;
  height: 38px;
  right: 1px;
  top: 1px;
  padding: 4px 8px;
  text-align: center;
  transition: transform .2s ease;
}

.multiselect__select:before {
  position: relative;
  right: 0;
  top: 65%;
  color: #999;
  margin-top: 4px;
  border-style: solid;
  border-width: 5px 5px 0;
  border-color: #999 transparent transparent;
  content: "";
}

.multiselect__placeholder {
  color: #adadad;
  display: inline-block;
  margin-bottom: 10px;
  padding-top: 2px;
}

.multiselect--active .multiselect__placeholder {
  display: none;
}

.multiselect__content-wrapper {
  position: absolute;
  display: block;
  background: #fff;
  width: 100%;
  max-height: 240px;
  overflow: auto;
  border: 1px solid #e8e8e8;
  border-top: none;
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
  z-index: 1;
  -webkit-overflow-scrolling: touch;
}

.multiselect__content {
  list-style: none;
  display: inline-block;
  padding: 0;
  margin: 0;
  min-width: 100%;
  vertical-align: top;
}

.multiselect--above .multiselect__content-wrapper {
  bottom: 100%;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom: none;
  border-top: 1px solid #e8e8e8;
}

.multiselect__content::webkit-scrollbar {
  display: none;
}

.multiselect__element {
  display: block;
}

.multiselect__option {
  display: block;
  padding: 12px;
  min-height: 40px;
  line-height: 16px;
  text-decoration: none;
  text-transform: none;
  vertical-align: middle;
  position: relative;
  cursor: pointer;
  white-space: nowrap;
}

.multiselect__option:after {
  top: 0;
  right: 0;
  position: absolute;
  line-height: 40px;
  padding-right: 12px;
  padding-left: 20px;
}

.multiselect__option--highlight {
  background: #41b883;
  outline: none;
  color: #fff;
}

.multiselect__option--highlight:after {
  content: attr(data-select);
  background: #41b883;
  color: #fff;
}

.multiselect__option--selected {
  background: #f3f3f3;
  color: #35495e;
  font-weight: 700;
}

.multiselect__option--selected:after {
  content: attr(data-selected);
  color: silver;
}

.multiselect__option--selected.multiselect__option--highlight {
  background: #ff6a6a;
  color: #fff;
}

.multiselect__option--selected.multiselect__option--highlight:after {
  background: #ff6a6a;
  content: attr(data-deselect);
  color: #fff;
}

.multiselect--disabled {
  background: #ededed;
  pointer-events: none;
}

.multiselect--disabled .multiselect__current,
.multiselect--disabled .multiselect__select,
.multiselect__option--disabled {
  background: #ededed;
  color: #a6a6a6;
}

.multiselect__option--disabled {
  cursor: text;
  pointer-events: none;
}

.multiselect__option--disabled.multiselect__option--highlight {
  background: #dedede!important;
}

.multiselect-enter-active,
.multiselect-leave-active {
  transition: all .15s ease;
}

.multiselect-enter,
.multiselect-leave-active {
  opacity: 0;
}

.multiselect__strong {
  margin-bottom: 8px;
  line-height: 20px;
  display: inline-block;
  vertical-align: top;
}

[dir=rtl] .multiselect {
  text-align: right;
}

[dir=rtl] .multiselect__select {
  right: auto;
  left: 1px;
}

[dir=rtl] .multiselect__tags {
  padding: 8px 8px 0 40px;
}

[dir=rtl] .multiselect__content {
  text-align: right;
}

[dir=rtl] .multiselect__option:after {
  right: auto;
  left: 0;
}

[dir=rtl] .multiselect__clear {
  right: auto;
  left: 12px;
}

[dir=rtl] .multiselect__spinner {
  right: auto;
  left: 1px;
}

@keyframes a {
  0% {
    transform: rotate(0);
  }

  to {
    transform: rotate(2turn);
  }
}</style><style type="text/css">@font-face {
  font-family: 'KaTeX_AMS';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_AMS-Regular-3d8245dcb4489694a6a263b05c1cca01.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_AMS-Regular-ac1d46d953d403677171697581a284d2.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_AMS-Regular-c67be87adba7d31c013be127b936233d.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Caligraphic';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold-970d3e76493b82fccf21ad5888ddee77.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold-445f96a387df0d13ded71f27c608516d.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Bold-3f61a84d76e80396489d32bc9dd8d444.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Caligraphic';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular-0ef0f2e356a2e1c457b6585d34edae77.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular-74f6918c7d2b768ffd32048102bc0172.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Caligraphic-Regular-c3bc8fcec0e85a50cabf71e4e8074991.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Fraktur';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold-950649ba5e5cfd37cdad74095411d350.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold-1aca7ef7f976fb54a207ffc8aa180e38.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Bold-e11e6bf02fc41279a540d3655abf3b07.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Fraktur';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular-135ccd74931753318f6f52f3fce19018.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular-c5b430bfcb3e5423b77401afcdb69b66.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Fraktur-Regular-a9509497466d16e6b7265a223ea39093.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Main';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Bold-82bce349c8ff0927380b5177e9258ad0.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Bold-29d4b276c622ff1d1376d9afcbd2f25a.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Bold-db576c7d5d6eb6ebefc9b334f4140d42.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Main';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic-13900e552dbf51aead905f897043226c.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic-3f3be43bbdd58a4a86c8eddd3d39a26a.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-BoldItalic-cec43f729e0e6810c3433f6020ec676e.ttf) format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'KaTeX_Main';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Italic-b488f60f79c9d1f533def644385d8219.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Italic-f8a754484e776e94b6116dfbcb1761a7.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Italic-85b3329fdb41fadfb0fdc01ec5290b2f.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}

@font-face {
  font-family: 'KaTeX_Main';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Regular-999cd6bac6e8118065ac500d4f133c63.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Regular-485696cf1d821baac6ae06c42e09faef.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Main-Regular-f4fe6dca4a5f5520ae0caab31848aae3.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Math';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Math-Italic-7a31741a44e58952cb4b8a763c206fcd.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Math-Italic-8eb56b3ff5b141cd3732a24e65c2b339.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Math-Italic-10740d7488d690a743339650103f1cb3.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}

@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold-0d0f967a34b828083a11bb264e578c32.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold-99bd87431ac7ef8f27591f72d7812509.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Bold-771a1f955e7ff2106402b58d1e8a1ad2.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic-b1ac79b9b69c954bbeb8fc02500832e0.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic-9c3f03ec809c6f298d716cbda8260fcb.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Italic-cb729d47fbd26ff0ae62bb840085e5b5.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}

@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular-23f1730fda70ec6ec6aa789979890cba.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular-fc90839714a9e877682309c3daf7493e.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_SansSerif-Regular-43b0cb92c2405f175772931ccd68002e.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Script';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Script-Regular-ae1fad1f4d1c227c9d567da8ea9f988c.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Script-Regular-60febfa114c5e32f0ce73050476aa39f.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Script-Regular-e9169ca7b32608b6235ec9ffff742a71.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Size1';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size1-Regular-fda0824e8cfb676664ad063c367cfce3.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size1-Regular-1d6cf6b89f694dc76e13ecc4e8214dd2.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size1-Regular-f2e296ef7cef0f6f16912e5d171929b2.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Size2';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size2-Regular-a7a0eb93afb696cb9b4efb87e6cd45a3.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size2-Regular-f48e83b7bcaa68a86a78e8edfee1a04e.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size2-Regular-0767ede65042583bcc06f09055f4d7ca.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Size3';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size3-Regular-397bd6872be7adff4f000c49fa85a9c3.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size3-Regular-0387ab387ace32f15b43c3a4a39f187f.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size3-Regular-882f723427a0986846fe786bd8d6f6c7.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Size4';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size4-Regular-3c14ed11dd8eea981c93bf283193856d.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size4-Regular-726db3bd435c8a6e45e44741dae67263.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Size4-Regular-27901d5ce93d8971c416d9123fedb911.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'KaTeX_Typewriter';
  src: url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular-895baecfbf4ef298fdfe943fb117c15e.woff2) format('woff2'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular-696705de367f02534e8abb38b55af067.woff) format('woff'), url(//cdn2.jianshu.io/assets/_/_/_/_/shared/node_modules/katex/dist/fonts/KaTeX_Typewriter-Regular-6374f53e08c02d7b9ec594e2fb0c5fe8.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}

.katex-display {
  display: block;
  margin: 1em 0;
  text-align: center;
}

.katex-display > .katex {
  display: inline-block;
  text-align: initial;
}

.katex {
  font: normal 1.21em KaTeX_Main, Times New Roman, serif;
  line-height: 1.2;
  white-space: nowrap;
  text-indent: 0;
  text-rendering: auto;
}

.katex * {
  -ms-high-contrast-adjust: none !important;
}

.katex .katex-html {
  display: inline-block;
}

.katex .katex-mathml {
  position: absolute;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 0;
  border: 0;
  height: 1px;
  width: 1px;
  overflow: hidden;
}

.katex .base {
  position: relative;
  display: inline-block;
}

.katex .strut {
  display: inline-block;
}

.katex .textbf {
  font-weight: bold;
}

.katex .textit {
  font-style: italic;
}

.katex .textrm {
  font-family: KaTeX_Main;
}

.katex .textsf {
  font-family: KaTeX_SansSerif;
}

.katex .texttt {
  font-family: KaTeX_Typewriter;
}

.katex .mathit {
  font-family: KaTeX_Math;
  font-style: italic;
}

.katex .mathrm {
  font-style: normal;
}

.katex .mathbf {
  font-family: KaTeX_Main;
  font-weight: bold;
}

.katex .boldsymbol {
  font-family: KaTeX_Math;
  font-weight: bold;
  font-style: italic;
}

.katex .amsrm {
  font-family: KaTeX_AMS;
}

.katex .mathbb {
  font-family: KaTeX_AMS;
}

.katex .mathcal {
  font-family: KaTeX_Caligraphic;
}

.katex .mathfrak {
  font-family: KaTeX_Fraktur;
}

.katex .mathtt {
  font-family: KaTeX_Typewriter;
}

.katex .mathscr {
  font-family: KaTeX_Script;
}

.katex .mathsf {
  font-family: KaTeX_SansSerif;
}

.katex .mainit {
  font-family: KaTeX_Main;
  font-style: italic;
}

.katex .mainrm {
  font-family: KaTeX_Main;
  font-style: normal;
}

.katex .vlist-t {
  display: inline-table;
  table-layout: fixed;
}

.katex .vlist-r {
  display: table-row;
}

.katex .vlist {
  display: table-cell;
  vertical-align: bottom;
  position: relative;
}

.katex .vlist > span {
  display: block;
  height: 0;
  position: relative;
}

.katex .vlist > span > span {
  display: inline-block;
}

.katex .vlist > span > .pstrut {
  overflow: hidden;
  width: 0;
}

.katex .vlist-t2 {
  margin-right: -2px;
}

.katex .vlist-s {
  display: table-cell;
  vertical-align: bottom;
  font-size: 1px;
  width: 2px;
}

.katex .msupsub {
  text-align: left;
}

.katex .mfrac > span > span {
  text-align: center;
}

.katex .mfrac .frac-line {
  display: inline-block;
  width: 100%;
}

.katex .mspace {
  display: inline-block;
}

.katex .mspace.negativethinspace {
  margin-left: -0.16667em;
}

.katex .mspace.muspace {
  width: 0.055556em;
}

.katex .mspace.thinspace {
  width: 0.16667em;
}

.katex .mspace.negativemediumspace {
  margin-left: -0.22222em;
}

.katex .mspace.mediumspace {
  width: 0.22222em;
}

.katex .mspace.thickspace {
  width: 0.27778em;
}

.katex .mspace.sixmuspace {
  width: 0.333333em;
}

.katex .mspace.eightmuspace {
  width: 0.444444em;
}

.katex .mspace.enspace {
  width: 0.5em;
}

.katex .mspace.twelvemuspace {
  width: 0.666667em;
}

.katex .mspace.quad {
  width: 1em;
}

.katex .mspace.qquad {
  width: 2em;
}

.katex .llap,
.katex .rlap,
.katex .clap {
  width: 0;
  position: relative;
}

.katex .llap > .inner,
.katex .rlap > .inner,
.katex .clap > .inner {
  position: absolute;
}

.katex .llap > .fix,
.katex .rlap > .fix,
.katex .clap > .fix {
  display: inline-block;
}

.katex .llap > .inner {
  right: 0;
}

.katex .rlap > .inner,
.katex .clap > .inner {
  left: 0;
}

.katex .clap > .inner > span {
  margin-left: -50%;
  margin-right: 50%;
}

.katex .rule {
  display: inline-block;
  border: solid 0;
  position: relative;
}

.katex .overline .overline-line,
.katex .underline .underline-line {
  display: inline-block;
  width: 100%;
}

.katex .sqrt > .root {
  margin-left: 0.27777778em;
  margin-right: -0.55555556em;
}

.katex .sizing,
.katex .fontsize-ensurer {
  display: inline-block;
}

.katex .sizing.reset-size1.size1,
.katex .fontsize-ensurer.reset-size1.size1 {
  font-size: 1em;
}

.katex .sizing.reset-size1.size2,
.katex .fontsize-ensurer.reset-size1.size2 {
  font-size: 1.2em;
}

.katex .sizing.reset-size1.size3,
.katex .fontsize-ensurer.reset-size1.size3 {
  font-size: 1.4em;
}

.katex .sizing.reset-size1.size4,
.katex .fontsize-ensurer.reset-size1.size4 {
  font-size: 1.6em;
}

.katex .sizing.reset-size1.size5,
.katex .fontsize-ensurer.reset-size1.size5 {
  font-size: 1.8em;
}

.katex .sizing.reset-size1.size6,
.katex .fontsize-ensurer.reset-size1.size6 {
  font-size: 2em;
}

.katex .sizing.reset-size1.size7,
.katex .fontsize-ensurer.reset-size1.size7 {
  font-size: 2.4em;
}

.katex .sizing.reset-size1.size8,
.katex .fontsize-ensurer.reset-size1.size8 {
  font-size: 2.88em;
}

.katex .sizing.reset-size1.size9,
.katex .fontsize-ensurer.reset-size1.size9 {
  font-size: 3.456em;
}

.katex .sizing.reset-size1.size10,
.katex .fontsize-ensurer.reset-size1.size10 {
  font-size: 4.148em;
}

.katex .sizing.reset-size1.size11,
.katex .fontsize-ensurer.reset-size1.size11 {
  font-size: 4.976em;
}

.katex .sizing.reset-size2.size1,
.katex .fontsize-ensurer.reset-size2.size1 {
  font-size: 0.83333333em;
}

.katex .sizing.reset-size2.size2,
.katex .fontsize-ensurer.reset-size2.size2 {
  font-size: 1em;
}

.katex .sizing.reset-size2.size3,
.katex .fontsize-ensurer.reset-size2.size3 {
  font-size: 1.16666667em;
}

.katex .sizing.reset-size2.size4,
.katex .fontsize-ensurer.reset-size2.size4 {
  font-size: 1.33333333em;
}

.katex .sizing.reset-size2.size5,
.katex .fontsize-ensurer.reset-size2.size5 {
  font-size: 1.5em;
}

.katex .sizing.reset-size2.size6,
.katex .fontsize-ensurer.reset-size2.size6 {
  font-size: 1.66666667em;
}

.katex .sizing.reset-size2.size7,
.katex .fontsize-ensurer.reset-size2.size7 {
  font-size: 2em;
}

.katex .sizing.reset-size2.size8,
.katex .fontsize-ensurer.reset-size2.size8 {
  font-size: 2.4em;
}

.katex .sizing.reset-size2.size9,
.katex .fontsize-ensurer.reset-size2.size9 {
  font-size: 2.88em;
}

.katex .sizing.reset-size2.size10,
.katex .fontsize-ensurer.reset-size2.size10 {
  font-size: 3.45666667em;
}

.katex .sizing.reset-size2.size11,
.katex .fontsize-ensurer.reset-size2.size11 {
  font-size: 4.14666667em;
}

.katex .sizing.reset-size3.size1,
.katex .fontsize-ensurer.reset-size3.size1 {
  font-size: 0.71428571em;
}

.katex .sizing.reset-size3.size2,
.katex .fontsize-ensurer.reset-size3.size2 {
  font-size: 0.85714286em;
}

.katex .sizing.reset-size3.size3,
.katex .fontsize-ensurer.reset-size3.size3 {
  font-size: 1em;
}

.katex .sizing.reset-size3.size4,
.katex .fontsize-ensurer.reset-size3.size4 {
  font-size: 1.14285714em;
}

.katex .sizing.reset-size3.size5,
.katex .fontsize-ensurer.reset-size3.size5 {
  font-size: 1.28571429em;
}

.katex .sizing.reset-size3.size6,
.katex .fontsize-ensurer.reset-size3.size6 {
  font-size: 1.42857143em;
}

.katex .sizing.reset-size3.size7,
.katex .fontsize-ensurer.reset-size3.size7 {
  font-size: 1.71428571em;
}

.katex .sizing.reset-size3.size8,
.katex .fontsize-ensurer.reset-size3.size8 {
  font-size: 2.05714286em;
}

.katex .sizing.reset-size3.size9,
.katex .fontsize-ensurer.reset-size3.size9 {
  font-size: 2.46857143em;
}

.katex .sizing.reset-size3.size10,
.katex .fontsize-ensurer.reset-size3.size10 {
  font-size: 2.96285714em;
}

.katex .sizing.reset-size3.size11,
.katex .fontsize-ensurer.reset-size3.size11 {
  font-size: 3.55428571em;
}

.katex .sizing.reset-size4.size1,
.katex .fontsize-ensurer.reset-size4.size1 {
  font-size: 0.625em;
}

.katex .sizing.reset-size4.size2,
.katex .fontsize-ensurer.reset-size4.size2 {
  font-size: 0.75em;
}

.katex .sizing.reset-size4.size3,
.katex .fontsize-ensurer.reset-size4.size3 {
  font-size: 0.875em;
}

.katex .sizing.reset-size4.size4,
.katex .fontsize-ensurer.reset-size4.size4 {
  font-size: 1em;
}

.katex .sizing.reset-size4.size5,
.katex .fontsize-ensurer.reset-size4.size5 {
  font-size: 1.125em;
}

.katex .sizing.reset-size4.size6,
.katex .fontsize-ensurer.reset-size4.size6 {
  font-size: 1.25em;
}

.katex .sizing.reset-size4.size7,
.katex .fontsize-ensurer.reset-size4.size7 {
  font-size: 1.5em;
}

.katex .sizing.reset-size4.size8,
.katex .fontsize-ensurer.reset-size4.size8 {
  font-size: 1.8em;
}

.katex .sizing.reset-size4.size9,
.katex .fontsize-ensurer.reset-size4.size9 {
  font-size: 2.16em;
}

.katex .sizing.reset-size4.size10,
.katex .fontsize-ensurer.reset-size4.size10 {
  font-size: 2.5925em;
}

.katex .sizing.reset-size4.size11,
.katex .fontsize-ensurer.reset-size4.size11 {
  font-size: 3.11em;
}

.katex .sizing.reset-size5.size1,
.katex .fontsize-ensurer.reset-size5.size1 {
  font-size: 0.55555556em;
}

.katex .sizing.reset-size5.size2,
.katex .fontsize-ensurer.reset-size5.size2 {
  font-size: 0.66666667em;
}

.katex .sizing.reset-size5.size3,
.katex .fontsize-ensurer.reset-size5.size3 {
  font-size: 0.77777778em;
}

.katex .sizing.reset-size5.size4,
.katex .fontsize-ensurer.reset-size5.size4 {
  font-size: 0.88888889em;
}

.katex .sizing.reset-size5.size5,
.katex .fontsize-ensurer.reset-size5.size5 {
  font-size: 1em;
}

.katex .sizing.reset-size5.size6,
.katex .fontsize-ensurer.reset-size5.size6 {
  font-size: 1.11111111em;
}

.katex .sizing.reset-size5.size7,
.katex .fontsize-ensurer.reset-size5.size7 {
  font-size: 1.33333333em;
}

.katex .sizing.reset-size5.size8,
.katex .fontsize-ensurer.reset-size5.size8 {
  font-size: 1.6em;
}

.katex .sizing.reset-size5.size9,
.katex .fontsize-ensurer.reset-size5.size9 {
  font-size: 1.92em;
}

.katex .sizing.reset-size5.size10,
.katex .fontsize-ensurer.reset-size5.size10 {
  font-size: 2.30444444em;
}

.katex .sizing.reset-size5.size11,
.katex .fontsize-ensurer.reset-size5.size11 {
  font-size: 2.76444444em;
}

.katex .sizing.reset-size6.size1,
.katex .fontsize-ensurer.reset-size6.size1 {
  font-size: 0.5em;
}

.katex .sizing.reset-size6.size2,
.katex .fontsize-ensurer.reset-size6.size2 {
  font-size: 0.6em;
}

.katex .sizing.reset-size6.size3,
.katex .fontsize-ensurer.reset-size6.size3 {
  font-size: 0.7em;
}

.katex .sizing.reset-size6.size4,
.katex .fontsize-ensurer.reset-size6.size4 {
  font-size: 0.8em;
}

.katex .sizing.reset-size6.size5,
.katex .fontsize-ensurer.reset-size6.size5 {
  font-size: 0.9em;
}

.katex .sizing.reset-size6.size6,
.katex .fontsize-ensurer.reset-size6.size6 {
  font-size: 1em;
}

.katex .sizing.reset-size6.size7,
.katex .fontsize-ensurer.reset-size6.size7 {
  font-size: 1.2em;
}

.katex .sizing.reset-size6.size8,
.katex .fontsize-ensurer.reset-size6.size8 {
  font-size: 1.44em;
}

.katex .sizing.reset-size6.size9,
.katex .fontsize-ensurer.reset-size6.size9 {
  font-size: 1.728em;
}

.katex .sizing.reset-size6.size10,
.katex .fontsize-ensurer.reset-size6.size10 {
  font-size: 2.074em;
}

.katex .sizing.reset-size6.size11,
.katex .fontsize-ensurer.reset-size6.size11 {
  font-size: 2.488em;
}

.katex .sizing.reset-size7.size1,
.katex .fontsize-ensurer.reset-size7.size1 {
  font-size: 0.41666667em;
}

.katex .sizing.reset-size7.size2,
.katex .fontsize-ensurer.reset-size7.size2 {
  font-size: 0.5em;
}

.katex .sizing.reset-size7.size3,
.katex .fontsize-ensurer.reset-size7.size3 {
  font-size: 0.58333333em;
}

.katex .sizing.reset-size7.size4,
.katex .fontsize-ensurer.reset-size7.size4 {
  font-size: 0.66666667em;
}

.katex .sizing.reset-size7.size5,
.katex .fontsize-ensurer.reset-size7.size5 {
  font-size: 0.75em;
}

.katex .sizing.reset-size7.size6,
.katex .fontsize-ensurer.reset-size7.size6 {
  font-size: 0.83333333em;
}

.katex .sizing.reset-size7.size7,
.katex .fontsize-ensurer.reset-size7.size7 {
  font-size: 1em;
}

.katex .sizing.reset-size7.size8,
.katex .fontsize-ensurer.reset-size7.size8 {
  font-size: 1.2em;
}

.katex .sizing.reset-size7.size9,
.katex .fontsize-ensurer.reset-size7.size9 {
  font-size: 1.44em;
}

.katex .sizing.reset-size7.size10,
.katex .fontsize-ensurer.reset-size7.size10 {
  font-size: 1.72833333em;
}

.katex .sizing.reset-size7.size11,
.katex .fontsize-ensurer.reset-size7.size11 {
  font-size: 2.07333333em;
}

.katex .sizing.reset-size8.size1,
.katex .fontsize-ensurer.reset-size8.size1 {
  font-size: 0.34722222em;
}

.katex .sizing.reset-size8.size2,
.katex .fontsize-ensurer.reset-size8.size2 {
  font-size: 0.41666667em;
}

.katex .sizing.reset-size8.size3,
.katex .fontsize-ensurer.reset-size8.size3 {
  font-size: 0.48611111em;
}

.katex .sizing.reset-size8.size4,
.katex .fontsize-ensurer.reset-size8.size4 {
  font-size: 0.55555556em;
}

.katex .sizing.reset-size8.size5,
.katex .fontsize-ensurer.reset-size8.size5 {
  font-size: 0.625em;
}

.katex .sizing.reset-size8.size6,
.katex .fontsize-ensurer.reset-size8.size6 {
  font-size: 0.69444444em;
}

.katex .sizing.reset-size8.size7,
.katex .fontsize-ensurer.reset-size8.size7 {
  font-size: 0.83333333em;
}

.katex .sizing.reset-size8.size8,
.katex .fontsize-ensurer.reset-size8.size8 {
  font-size: 1em;
}

.katex .sizing.reset-size8.size9,
.katex .fontsize-ensurer.reset-size8.size9 {
  font-size: 1.2em;
}

.katex .sizing.reset-size8.size10,
.katex .fontsize-ensurer.reset-size8.size10 {
  font-size: 1.44027778em;
}

.katex .sizing.reset-size8.size11,
.katex .fontsize-ensurer.reset-size8.size11 {
  font-size: 1.72777778em;
}

.katex .sizing.reset-size9.size1,
.katex .fontsize-ensurer.reset-size9.size1 {
  font-size: 0.28935185em;
}

.katex .sizing.reset-size9.size2,
.katex .fontsize-ensurer.reset-size9.size2 {
  font-size: 0.34722222em;
}

.katex .sizing.reset-size9.size3,
.katex .fontsize-ensurer.reset-size9.size3 {
  font-size: 0.40509259em;
}

.katex .sizing.reset-size9.size4,
.katex .fontsize-ensurer.reset-size9.size4 {
  font-size: 0.46296296em;
}

.katex .sizing.reset-size9.size5,
.katex .fontsize-ensurer.reset-size9.size5 {
  font-size: 0.52083333em;
}

.katex .sizing.reset-size9.size6,
.katex .fontsize-ensurer.reset-size9.size6 {
  font-size: 0.5787037em;
}

.katex .sizing.reset-size9.size7,
.katex .fontsize-ensurer.reset-size9.size7 {
  font-size: 0.69444444em;
}

.katex .sizing.reset-size9.size8,
.katex .fontsize-ensurer.reset-size9.size8 {
  font-size: 0.83333333em;
}

.katex .sizing.reset-size9.size9,
.katex .fontsize-ensurer.reset-size9.size9 {
  font-size: 1em;
}

.katex .sizing.reset-size9.size10,
.katex .fontsize-ensurer.reset-size9.size10 {
  font-size: 1.20023148em;
}

.katex .sizing.reset-size9.size11,
.katex .fontsize-ensurer.reset-size9.size11 {
  font-size: 1.43981481em;
}

.katex .sizing.reset-size10.size1,
.katex .fontsize-ensurer.reset-size10.size1 {
  font-size: 0.24108004em;
}

.katex .sizing.reset-size10.size2,
.katex .fontsize-ensurer.reset-size10.size2 {
  font-size: 0.28929605em;
}

.katex .sizing.reset-size10.size3,
.katex .fontsize-ensurer.reset-size10.size3 {
  font-size: 0.33751205em;
}

.katex .sizing.reset-size10.size4,
.katex .fontsize-ensurer.reset-size10.size4 {
  font-size: 0.38572806em;
}

.katex .sizing.reset-size10.size5,
.katex .fontsize-ensurer.reset-size10.size5 {
  font-size: 0.43394407em;
}

.katex .sizing.reset-size10.size6,
.katex .fontsize-ensurer.reset-size10.size6 {
  font-size: 0.48216008em;
}

.katex .sizing.reset-size10.size7,
.katex .fontsize-ensurer.reset-size10.size7 {
  font-size: 0.57859209em;
}

.katex .sizing.reset-size10.size8,
.katex .fontsize-ensurer.reset-size10.size8 {
  font-size: 0.69431051em;
}

.katex .sizing.reset-size10.size9,
.katex .fontsize-ensurer.reset-size10.size9 {
  font-size: 0.83317261em;
}

.katex .sizing.reset-size10.size10,
.katex .fontsize-ensurer.reset-size10.size10 {
  font-size: 1em;
}

.katex .sizing.reset-size10.size11,
.katex .fontsize-ensurer.reset-size10.size11 {
  font-size: 1.19961427em;
}

.katex .sizing.reset-size11.size1,
.katex .fontsize-ensurer.reset-size11.size1 {
  font-size: 0.20096463em;
}

.katex .sizing.reset-size11.size2,
.katex .fontsize-ensurer.reset-size11.size2 {
  font-size: 0.24115756em;
}

.katex .sizing.reset-size11.size3,
.katex .fontsize-ensurer.reset-size11.size3 {
  font-size: 0.28135048em;
}

.katex .sizing.reset-size11.size4,
.katex .fontsize-ensurer.reset-size11.size4 {
  font-size: 0.32154341em;
}

.katex .sizing.reset-size11.size5,
.katex .fontsize-ensurer.reset-size11.size5 {
  font-size: 0.36173633em;
}

.katex .sizing.reset-size11.size6,
.katex .fontsize-ensurer.reset-size11.size6 {
  font-size: 0.40192926em;
}

.katex .sizing.reset-size11.size7,
.katex .fontsize-ensurer.reset-size11.size7 {
  font-size: 0.48231511em;
}

.katex .sizing.reset-size11.size8,
.katex .fontsize-ensurer.reset-size11.size8 {
  font-size: 0.57877814em;
}

.katex .sizing.reset-size11.size9,
.katex .fontsize-ensurer.reset-size11.size9 {
  font-size: 0.69453376em;
}

.katex .sizing.reset-size11.size10,
.katex .fontsize-ensurer.reset-size11.size10 {
  font-size: 0.83360129em;
}

.katex .sizing.reset-size11.size11,
.katex .fontsize-ensurer.reset-size11.size11 {
  font-size: 1em;
}

.katex .delimsizing.size1 {
  font-family: KaTeX_Size1;
}

.katex .delimsizing.size2 {
  font-family: KaTeX_Size2;
}

.katex .delimsizing.size3 {
  font-family: KaTeX_Size3;
}

.katex .delimsizing.size4 {
  font-family: KaTeX_Size4;
}

.katex .delimsizing.mult .delim-size1 > span {
  font-family: KaTeX_Size1;
}

.katex .delimsizing.mult .delim-size4 > span {
  font-family: KaTeX_Size4;
}

.katex .nulldelimiter {
  display: inline-block;
  width: 0.12em;
}

.katex .delimcenter {
  position: relative;
}

.katex .op-symbol {
  position: relative;
}

.katex .op-symbol.small-op {
  font-family: KaTeX_Size1;
}

.katex .op-symbol.large-op {
  font-family: KaTeX_Size2;
}

.katex .op-limits > .vlist-t {
  text-align: center;
}

.katex .accent > .vlist-t {
  text-align: center;
}

.katex .accent .accent-body {
  width: 0;
  position: relative;
}

.katex .overlay {
  display: block;
}

.katex .mtable .vertical-separator {
  display: inline-block;
  margin: 0 -0.125em;
  width: 0.25em;
}

.katex .mtable .arraycolsep {
  display: inline-block;
}

.katex .mtable .col-align-c > .vlist-t {
  text-align: center;
}

.katex .mtable .col-align-l > .vlist-t {
  text-align: left;
}

.katex .mtable .col-align-r > .vlist-t {
  text-align: right;
}

.katex .svg-align {
  text-align: left;
}

.katex svg {
  display: block;
  position: absolute;
  width: 100%;
  fill: currentColor;
  stroke: currentColor;
  fill-rule: nonzero;
  fill-opacity: 1;
  stroke-width: 1;
  stroke-linecap: butt;
  stroke-linejoin: miter;
  stroke-miterlimit: 4;
  stroke-dasharray: none;
  stroke-dashoffset: 0;
  stroke-opacity: 1;
}

.katex svg path {
  stroke: none;
}

.katex .vertical-separator svg {
  width: 0.25em;
}

.katex .stretchy {
  width: 100%;
  display: block;
}

.katex .stretchy:before,
.katex .stretchy:after {
  content: "";
}

.katex .hide-tail {
  width: 100%;
  position: relative;
  overflow: hidden;
}

.katex .halfarrow-left {
  position: absolute;
  left: 0;
  width: 50.1%;
  overflow: hidden;
}

.katex .halfarrow-right {
  position: absolute;
  right: 0;
  width: 50%;
  overflow: hidden;
}

.katex .brace-left {
  position: absolute;
  left: 0;
  width: 25.1%;
  overflow: hidden;
}

.katex .brace-center {
  position: absolute;
  left: 25%;
  width: 50%;
  overflow: hidden;
}

.katex .brace-right {
  position: absolute;
  right: 0;
  width: 25.1%;
  overflow: hidden;
}

.katex .x-arrow-pad {
  padding: 0 0.5em;
}

.katex .x-arrow,
.katex .mover,
.katex .munder {
  text-align: center;
}

.katex .boxpad {
  padding: 0 0.3em 0 0.3em;
}

.katex .fbox {
  box-sizing: border-box;
  border: 0.04em solid black;
}

.katex .fcolorbox {
  box-sizing: border-box;
  border: 0.04em solid;
}

.katex .cancel-pad {
  padding: 0 0.2em 0 0.2em;
}

.katex .mord + .cancel-lap,
.katex .mbin + .cancel-lap {
  margin-left: -0.2em;
}

.katex .cancel-lap + .mord,
.katex .cancel-lap + .mbin,
.katex .cancel-lap + .msupsub {
  margin-left: -0.2em;
}

.katex .sout {
  border-bottom-style: solid;
  border-bottom-width: 0.08em;
}</style><style type="text/css">
#free-reward-panel .reward-users-modal main {
  padding: 0;
}
</style><style type="text/css">
@charset "UTF-8";
/*
 * 变量
*/
.reward-note-modal .v-modal {
  width: 620px;
  text-align: center;
}
.reward-note-modal .v-modal form {
    margin: 0 auto 25px auto;
    padding: 0 40px;
}
.reward-note-modal .v-modal .reward-intro {
    margin-top: 20px;
    margin-bottom: 20px;
    font-size: 16px;
}
.reward-note-modal .v-modal .reward-intro .avatar {
      cursor: default !important;
      width: 36px;
      height: 36px;
      margin-right: 10px;
      display: inline-block;
}
.reward-note-modal .v-modal .reward-intro .intro {
      margin-right: 5px;
      font-weight: bold;
      vertical-align: middle;
}
.reward-note-modal .v-modal .reward-intro i {
      color: #EA6F5A;
      vertical-align: middle;
}
.reward-note-modal .v-modal .main-inputs {
    margin: 25px 0;
}
.reward-note-modal .v-modal .main-inputs .amount-group {
      margin: 0 -5px;
}
.reward-note-modal .v-modal .main-inputs .amount-group input {
        display: none;
}
.reward-note-modal .v-modal .main-inputs .amount-group input:checked + .option {
        color: #EA6F5A;
        border-color: #EA6F5A;
}
.reward-note-modal .v-modal .main-inputs .amount-group .custom-amount:checked + .option .custom-text {
        opacity: 0;
}
.reward-note-modal .v-modal .main-inputs .amount-group .custom-amount:checked + .option .custom-amount-input {
        opacity: 1;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option {
        position: relative;
        margin: 0 5px 15px;
        width: 156px;
        height: 56px;
        line-height: 54px;
        border: 1px solid #E6E6E6;
        border-radius: 4px;
        font-weight: normal;
        color: #999999;
        cursor: pointer;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option i {
          font-size: 16px;
          vertical-align: middle;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .amount {
          font-size: 28px;
          vertical-align: middle;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .piece {
          font-size: 13px;
          vertical-align: sub;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input {
          position: absolute;
          top: 0;
          z-index: -1;
          width: 100%;
          opacity: 0;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input i {
            position: absolute;
            top: 0;
            left: 10px;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input .piece {
            position: absolute;
            top: 4px;
            right: 10px;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input input {
            display: block;
            margin: 0 auto;
            width: 80px;
            height: 54px;
            line-height: 54px;
            border: none;
            font-size: 28px;
            text-align: center;
            background: transparent;
            -moz-appearance: textfield;
}
.reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input input::-webkit-outer-spin-button, .reward-note-modal .v-modal .main-inputs .amount-group .option .custom-amount-input input::-webkit-inner-spin-button {
              -webkit-appearance: none !important;
}
.reward-note-modal .v-modal .main-inputs .message {
      padding: 15px 20px;
      margin-bottom: 0;
      font-size: 14px;
      border: 1px solid #E6E6E6;
      color: #333333;
      border-radius: 4px;
      background-color: rgba(180, 180, 180, 0.1);
}
.reward-note-modal .v-modal .main-inputs .message textarea {
        width: 100%;
        height: 44px;
        padding: 0;
        margin: 0;
        resize: none;
        background: none !important;
        border: none !important;
        -webkit-box-sizing: border-box;
                box-sizing: border-box;
        -webkit-box-shadow: none;
                box-shadow: none;
}
.reward-note-modal .v-modal .main-inputs .message textarea:focus {
          outline: none;
}
.reward-note-modal .v-modal .reward-info .amount {
    font-size: 28px;
    font-weight: bold;
    color: #EA6F5A;
}
.reward-note-modal .v-modal .reward-info .pay-method {
    font-size: 14px;
}
.reward-note-modal .v-modal .reward-info .pay-method a {
      color: #3194D0;
}
.reward-note-modal .v-modal .choose-pay {
    margin: 0 -5px;
}
.reward-note-modal .v-modal .choose-pay input {
      display: none;
}
.reward-note-modal .v-modal .choose-pay input:checked + .option {
      color: #EA6F5A;
      border-color: #EA6F5A;
}
.reward-note-modal .v-modal .choose-pay .option {
      margin: 20px 5px 10px;
      width: 156px;
      height: 56px;
      line-height: 54px;
      text-align: center;
      border: 1px solid #E6E6E6;
      border-radius: 4px;
      cursor: pointer;
}
.reward-note-modal .v-modal .choose-pay .option img {
        height: 30px;
}
.reward-note-modal .v-modal .choose-pay .option img.day.alipay, .reward-note-modal .v-modal .choose-pay .option img.night.alipay {
        min-width: 85px;
}
.reward-note-modal .v-modal .choose-pay .option img.day.wechat, .reward-note-modal .v-modal .choose-pay .option img.night.wechat {
        min-width: 112px;
}
.reward-note-modal .v-modal .choose-pay .option img.night {
        display: none;
}
.reward-note-modal .v-modal .choose-pay .tooltip {
      width: 230px;
}
.reward-note-modal .v-modal .modal-footer {
    padding: 0 15px 20px;
    border: none;
    background-color: transparent;
    text-align: center;
}
.reward-note-modal .v-modal .modal-footer .btn {
      padding: 8px 45px;
      font-size: 24px;
}
.reward-note-modal .v-modal .btn-pay {
    padding: 8px 25px;
    font-size: 16px;
    color: #ffffff;
    background-color: #F5A623;
}
.weixin-pay, .success-pay {
  text-align: center;
}
.weixin-pay .v-modal, .success-pay .v-modal {
    width: 350px;
}
.weixin-pay .ic-successed, .success-pay .ic-successed {
    font-size: 60px;
    color: #3db922;
}
.weixin-pay h2, .weixin-pay h3, .success-pay h2, .success-pay h3 {
    margin-bottom: 20px;
    color: #333333;
}
.weixin-pay h2, .success-pay h2 {
    margin: 0 0 40px 0;
    font-size: 24px;
}
.weixin-pay .bind-text, .success-pay .bind-text {
    position: relative;
    margin-bottom: 30px;
    font-size: 14px;
    color: #999999;
}
.weixin-pay .bind-text:before, .weixin-pay .bind-text:after, .success-pay .bind-text:before, .success-pay .bind-text:after {
      content: "";
      border-top: 1px solid #999;
      display: block;
      position: absolute;
      width: 40px;
      top: 8px;
}
.weixin-pay .bind-text:before, .success-pay .bind-text:before {
      left: 30px;
}
.weixin-pay .bind-text:after, .success-pay .bind-text:after {
      right: 30px;
}
.weixin-pay .share-bind, .success-pay .share-bind {
    display: block;
    margin-bottom: 30px;
}
.weixin-pay .share-bind i, .success-pay .share-bind i {
      margin-right: 4px;
      font-size: 22px;
      vertical-align: middle;
}
.weixin-pay .share-bind.wechat i, .success-pay .share-bind.wechat i {
      color: #00BB29;
}
.weixin-pay .share-bind.weibo i, .success-pay .share-bind.weibo i {
      color: #E05244;
}
.weixin-pay .wx-qr-code, .success-pay .wx-qr-code {
    display: inline-block;
}
.weixin-pay .wx-qr-code img, .success-pay .wx-qr-code img {
      margin: 0 auto;
      padding: 10px;
      width: 200px;
      background-color: #ffffff;
}
.weixin-pay .pay-amount, .success-pay .pay-amount {
    margin: 20px 0;
    color: #787878;
}
.weixin-pay .pay-amount span, .success-pay .pay-amount span {
      color: #F5A623;
}
</style><style type="text/css">
@charset "UTF-8";
/*
 * 变量
*/
.v-modal-wrap {
  position: fixed;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: 9999;
  background-color: transparent;
}
.v-modal-wrap.modal-leave-active {
    -webkit-transition: opacity 0.3s;
    -o-transition: opacity 0.3s;
    transition: opacity 0.3s;
}
.v-modal-wrap.modal-enter-active .v-modal-mask, .v-modal-wrap.modal-leave-active .v-modal-mask {
    opacity: 0;
}
.v-modal-wrap.modal-enter-active .v-modal, .v-modal-wrap.modal-leave-active .v-modal {
    -webkit-transform: translate(-50%, -70%);
        -ms-transform: translate(-50%, -70%);
            transform: translate(-50%, -70%);
    opacity: 0;
}
.v-modal-wrap .v-modal-mask {
    background-color: rgba(255, 255, 255, 0.7);
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    -webkit-transition: opacity 0.3s;
    -o-transition: opacity 0.3s;
    transition: opacity 0.3s;
    opacity: 1;
}
.v-modal-wrap .v-modal {
    position: absolute;
    left: 50%;
    top: 50%;
    -webkit-transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
    border-radius: 6px;
    border: 1px solid rgba(0, 0, 0, 0.1);
    background-color: #fff;
    -webkit-box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
    -webkit-transition: opacity 0.3s, -webkit-transform 0.3s;
    transition: opacity 0.3s, -webkit-transform 0.3s;
    -o-transition: opacity 0.3s, transform 0.3s;
    transition: opacity 0.3s, transform 0.3s;
    transition: opacity 0.3s, transform 0.3s, -webkit-transform 0.3s;
    opacity: 1;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -webkit-flex-direction: column;
        -ms-flex-direction: column;
            flex-direction: column;
    overflow: hidden;
}
.v-modal-wrap .v-modal > header:before, .v-modal-wrap .v-modal > header:after, .v-modal-wrap .v-modal > main:before, .v-modal-wrap .v-modal > main:after, .v-modal-wrap .v-modal > footer:before, .v-modal-wrap .v-modal > footer:after {
      content: '';
      clear: both;
      display: table;
}
.v-modal-wrap .v-modal > header {
      padding: 20px;
      border-bottom: 1px solid #F0F0F0;
}
.v-modal-wrap .v-modal > header h4 {
        margin: 0;
        color: #333;
        text-align: left;
}
.v-modal-wrap .v-modal .close {
      position: absolute;
      right: 16px;
      top: 20px;
      font-size: 26px;
      line-height: 20px;
      color: rgba(0, 0, 0, 0.8);
}
.v-modal-wrap .v-modal .close:hover {
        color: #000000;
}
.v-modal-wrap .v-modal > main {
      padding: 20px 20px 20px 20px;
      font-size: 15px;
      color: #333;
      -webkit-box-flex: 1;
      -webkit-flex-grow: 1;
          -ms-flex-positive: 1;
              flex-grow: 1;
      overflow-x: hidden;
      overflow-y: auto;
}
.v-modal-wrap .v-modal > footer {
      padding: 20px;
      background-color: #fff;
}
.v-modal-wrap .v-modal > footer button {
        padding: 0;
        margin: 0;
        background-color: transparent;
        border: 0;
        float: right;
}
.v-modal-wrap .v-modal > footer button:focus {
          outline: 0;
}
.v-modal-wrap .v-modal > footer .submit {
        padding: 4px 12px;
        border: 1px solid;
        border-radius: 20px;
}
.v-modal-wrap .v-modal > footer .cancel {
        margin-top: 5px;
}
.v-modal-wrap .v-modal > footer .cancel:hover {
          color: #333333;
}
.reader-night-mode .v-modal-wrap .v-modal-mask {
  background-color: rgba(63, 63, 63, 0.7);
}
.reader-night-mode .v-modal-wrap .v-modal {
  background-color: #3f3f3f;
}
.reader-night-mode .v-modal-wrap .v-modal header {
    border-color: #2F2F2F;
}
.reader-night-mode .v-modal-wrap .v-modal header h4 {
      color: #C8C8C8;
}
.reader-night-mode .v-modal-wrap .v-modal .close {
    color: #C8C8C8;
}
.reader-night-mode .v-modal-wrap .v-modal .close:hover {
      color: #ffffff;
}
.reader-night-mode .v-modal-wrap .v-modal main {
    color: #C8C8C8;
}
.reader-night-mode .v-modal-wrap .v-modal footer {
    background-color: #3f3f3f;
}
.reader-night-mode .v-modal-wrap .v-modal footer .cancel:hover {
      color: #C8C8C8;
}
</style><style type="text/css">
@charset "UTF-8";
/*
 * 变量
*/
.like[data-v-6ddd02c6] {
  display: inline-block;
}
.like .like-group[data-v-6ddd02c6] {
    position: relative;
    padding: 13px 0 15px 0;
    font-size: 0;
    border: 1px solid #EA6F5A;
    border-radius: 40px;
}
.like .like-group[data-v-6ddd02c6]:hover {
      background-color: rgba(236, 97, 73, 0.05);
}
.like .like-group .btn-like[data-v-6ddd02c6] {
      display: inline-block;
      font-size: 19px;
}
.like .like-group .btn-like[data-v-6ddd02c6]:before {
        content: '';
        position: absolute;
        left: 12px;
        top: 2px;
        width: 50px;
        height: 50px;
        background-image: url(//cdn2.jianshu.io/assets/web/like_animation_steps-62a00a7b52377d3069927cdb8e61fd34.png);
        background-position: left;
        background-repeat: no-repeat;
        background-size: 1000px 50px;
}
.like .like-group .btn-like a[data-v-6ddd02c6] {
        position: relative;
        padding: 18px 30px 18px 55px;
        color: #EA6F5A;
}
.like .like-group .modal-wrap[data-v-6ddd02c6] {
      font-size: 18px;
      border-left: 1px solid rgba(236, 97, 73, 0.4);
      display: inline-block;
      margin-left: -15px;
}
.like .like-group .modal-wrap a[data-v-6ddd02c6] {
        color: #EA6F5A;
        padding: 18px 26px 18px 18px;
}
.like .like-group.like-animation[data-v-6ddd02c6], .like .like-group.active[data-v-6ddd02c6] {
      background-color: #EA6F5A;
}
.like .like-group.like-animation .btn-like a[data-v-6ddd02c6], .like .like-group.active .btn-like a[data-v-6ddd02c6] {
        color: white;
}
.like .like-group.like-animation .modal-wrap[data-v-6ddd02c6], .like .like-group.active .modal-wrap[data-v-6ddd02c6] {
        border-left: 1px solid white;
}
.like .like-group.like-animation .modal-wrap a[data-v-6ddd02c6], .like .like-group.active .modal-wrap a[data-v-6ddd02c6] {
          color: white;
}
.like .like-group.like-animation .btn-like[data-v-6ddd02c6]:before {
      -webkit-animation: likeBlast-data-v-6ddd02c6 0.6s 1 steps(19);
              animation: likeBlast-data-v-6ddd02c6 0.6s 1 steps(19);
      background-position: right;
}
@-webkit-keyframes likeBlast {
0% {
    background-position: left;
}
100% {
    background-position: right;
}
}
@keyframes likeBlast-data-v-6ddd02c6 {
0% {
    background-position: left;
}
100% {
    background-position: right;
}
}
.like .like-group.active .btn-like[data-v-6ddd02c6]:before {
      background-position: right;
}
</style><style type="text/css">
@charset "UTF-8";
/*
 * 变量
*/
.main {
  position: relative;
  margin: 0 auto;
  padding: 0 0 30px 0;
  width: 620px;
}
.main .title {
    padding-left: 8px;
    border-left: 3px solid #EA6F5A;
    line-height: 1;
    font-size: 15px;
}
.main .collection-settings {
    position: absolute;
    top: 2px;
    right: 0;
    font-size: 13px;
    color: #A0A0A0;
}
.main .collection-settings span {
      padding-left: 4px;
}
.main .include-collection {
    width: 100%;
    padding-top: 20px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
        -ms-flex-direction: row;
            flex-direction: row;
    -webkit-box-pack: start;
    -webkit-justify-content: flex-start;
        -ms-flex-pack: start;
            justify-content: flex-start;
    -webkit-box-align: center;
    -webkit-align-items: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-flex-wrap: wrap;
        -ms-flex-wrap: wrap;
            flex-wrap: wrap;
}
.main .include-collection .item {
      display: inline-block;
      margin: 0 12px 12px 0;
      min-height: 32px;
      background-color: white;
      border: 1px solid #DCDCDC;
      border-radius: 4px;
      vertical-align: top;
      overflow: hidden;
}
.main .include-collection .item img {
        width: 32px;
        height: 32px;
}
.main .include-collection .item .name {
        display: inline-block;
        padding: 0 10px;
        font-size: 14px;
}
.main .include-collection .add-collection-wrap {
      margin: 0 12px 12px 0;
}
.main .include-collection .add-collection {
      padding: 8px 12px;
      font-size: 14px;
      border: 1px solid #DCDCDC;
      border-radius: 4px;
}
.main .include-collection .add-collection i {
        margin-right: 4px;
        color: #969696;
}
.main .recommend-note a {
    position: relative;
    margin: 20px 2px 0 0;
    width: 200px;
    height: 160px;
    display: inline-block;
}
.main .recommend-note a:after {
      content: "";
      position: absolute;
      width: 200px;
      height: 160px;
      border-radius: 0 0 4px 4px;
      -webkit-box-shadow: inset 0px -80px 50px -22px rgba(0, 0, 0, 0.6);
              box-shadow: inset 0px -80px 50px -22px rgba(0, 0, 0, 0.6);
      top: 0;
      left: 0;
      z-index: 1;
}
.main .recommend-note .name {
    position: absolute;
    bottom: 40px;
    left: 10px;
    right: 10px;
    font-size: 17px;
    font-weight: bold;
    color: #ffffff;
    z-index: 2;
}
.main .recommend-note .author {
    position: absolute;
    bottom: 10px;
    left: 10px;
    right: 10px;
    z-index: 2;
}
.main .recommend-note .avatar {
    width: 20px;
    height: 20px;
    display: inline-block;
}
.main .recommend-note .avatar img {
      border-radius: 50%;
}
.main .recommend-note .author-name {
    font-size: 12px;
    color: #ffffff;
    display: inline-block;
    vertical-align: -1px;
}
.main .show-more {
    margin: 0 12px 12px 0;
    font-size: 14px;
    color: #A0A0A0;
}
</style></head>

  <body lang="zh-CN" class="reader-black-font" style="">
    <!-- 全局顶部导航栏 -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="width-limit">
    <!-- 左上方 Logo -->
    <a class="logo" href="https://www.jianshu.com/"><img src="./Android WebView 全面干货指南 - 简书_files/nav-logo-4c7bbafe27adc892f3046e6978459bac.png" alt="Nav logo"></a>

    <!-- 右上角 -->
      <!-- 未登录显示登录/注册/写文章 -->
      <a class="btn write-btn" target="_blank" href="https://www.jianshu.com/writer#/">
        <i class="iconfont ic-write"></i>写文章
</a>      <a class="btn sign-up" href="https://www.jianshu.com/sign_up">注册</a>
      <a class="btn log-in" href="https://www.jianshu.com/sign_in">登录</a>

    <!-- 如果用户登录，显示下拉菜单 -->

    <div class="style-mode"><a class="style-mode-btn"><i class="iconfont ic-navigation-mode"></i></a> <div class="popover-modal" style="left: 0px; display: none;"><div class="meta"><i class="iconfont ic-navigation-night"></i><span>夜间模式</span></div> <div class="switch day-night-group"><a class="switch-btn">开</a> <a class="switch-btn active">关</a></div> <hr> <div class="switch font-family-group"><a class="switch-btn font-song">宋体</a> <a class="switch-btn font-hei active">黑体</a></div> <div class="switch"><a class="switch-btn active">简</a> <a class="switch-btn">繁</a></div></div></div>
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu" aria-expanded="false">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <div class="collapse navbar-collapse" id="menu">
        <ul class="nav navbar-nav">
            <li class="tab ">
              <a href="https://www.jianshu.com/">
                <span class="menu-text">首页</span><i class="iconfont ic-navigation-discover menu-icon"></i>
</a>            </li>
            <li class="tab ">
              <a id="web-nav-app-download-btn" class="app-download-btn" href="https://www.jianshu.com/apps?utm_medium=desktop&amp;utm_source=navbar-apps"><span class="menu-text">下载App</span><i class="iconfont ic-navigation-download menu-icon"></i></a>
            </li>
          <li class="search">
            <form target="_blank" action="https://www.jianshu.com/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
              <input type="text" name="q" id="q" value="" autocomplete="off" placeholder="搜索" class="search-input">
              <a class="search-btn" href="javascript:void(null)"><i class="iconfont ic-search"></i></a>
</form>          </li>
        </ul>
      </div>
    </div>
  </div>
</nav>

    
<div class="note">
  <a target="_blank" href="https://www.jianshu.com/apps/download?utm_source=sbc" id="web-note-ad-fixed" style="left: 1025.5px;"><span class="close">×</span></a>
  <div class="post">
    <div class="article">
        <h1 class="title">Android WebView 全面干货指南</h1>

        <!-- 作者区域 -->
        <div class="author">
          <a class="avatar" href="https://www.jianshu.com/u/fa272f63280a">
            <img src="./Android WebView 全面干货指南 - 简书_files/2d442a0d8106" alt="96">
</a>          <div class="info">
            <span class="name"><a href="https://www.jianshu.com/u/fa272f63280a">無名小子的杂货铺</a></span>
            <!-- 关注用户按钮 -->
            <a class="btn btn-success follow"><i class="iconfont ic-follow"></i><span>关注</span></a>
            <!-- 文章数据信息 -->
            <div class="meta">
              <!-- 如果文章更新时间大于发布时间，那么使用 tooltip 显示更新时间 -->
                <span class="publish-time" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="最后编辑于 2017.11.17 15:19">2017.10.30 22:53*</span>
              <span class="wordage">字数 7255</span>
            <span class="views-count">阅读 2026</span><span class="comments-count">评论 7</span><span class="likes-count">喜欢 42</span></div>
          </div>
          <!-- 如果是当前作者，加入编辑按钮 -->
        </div>

        <!-- 文章内容 -->
        <div data-note-content="" class="show-content">
          <div class="show-content-free">
            <h3>前言</h3>
<blockquote>
<p>总结 Android WebView 常用的相关知识点，令包含以下干货内容分析：Js注入漏洞、WebView 遇到的坑、JsBridge 原理以及框架使用(<a href="https://link.jianshu.com/?t=https://github.com/lzyzsd/JsBridge" target="_blank" rel="nofollow">JsBridge</a>,<a href="https://link.jianshu.com/?t=https://github.com/whiskeyfei/DSBridge-Android" target="_blank" rel="nofollow">DSBridge-Android</a>)、缓存机制应用、性能优化、腾讯开源框架 VasSonic (之后会进行代码分析)。</p>
</blockquote>
<hr>
<h3>目录</h3>
<div class="image-package">
<div class="image-container" style="max-width: 661px; max-height: 926px; background-color: transparent;">
<div class="image-container-fill" style="padding-bottom: 132.38%;"></div>
<div class="image-view" data-width="661" data-height="875"><img data-original-src="//upload-images.jianshu.io/upload_images/877678-858a41d06f0df835.png" data-original-width="661" data-original-height="875" data-original-format="image/png" data-original-filesize="88070" class="" style="cursor: zoom-in;" src="./Android WebView 全面干货指南 - 简书_files/877678-858a41d06f0df835.png"></div>
</div>
<div class="image-caption">目录</div>
</div>
<h3>一、简介</h3>
<p>这部分主要介绍下 WebView，WebView 是一个用来显示 Web 网页的控件，继承自 AbsoluteLayout，和使用系统其他控件没什么区别，只是 WeView 控件方法比较多比较丰富。因为它就是一个微型浏览器，包含一个浏览器该有的基本功能，例如：滚动、缩放、前进、后退下一页、搜索、执行 Js等功能。</p>
<blockquote>
<p>在 Android 4.4 之前使用 WebKit 作为渲染内核，4.4 之后采用 chrome 内核。Api 使用兼容低版本。</p>
</blockquote>
<p><a href="https://link.jianshu.com/?t=https://developer.android.com/reference/android/webkit/WebView.html" target="_blank" rel="nofollow">官方 WebView.html</a><br>
A View that displays web pages. This class is the basis upon which you can roll your own web browser or simply display some online content within your Activity. It uses the WebKit rendering engine to display web pages and includes methods to navigate forward and backward through a history, zoom in and out, perform text searches and more.</p>
<hr>
<h3>二、基本使用</h3>
<pre class="hljs php"><code class="php"><span class="hljs-comment">//配置网络权限</span>
&lt;uses-permission android:name=<span class="hljs-string">"android.permission.INTERNET"</span>/&gt;

 <span class="hljs-comment">//布局</span>
<span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span><span class="hljs-meta">?&gt;</span>
    &lt;LinearLayout
      xmlns:android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
      android:id=<span class="hljs-string">"@+id/main"</span>
      android:layout_width=<span class="hljs-string">"match_parent"</span>
      android:layout_height=<span class="hljs-string">"match_parent"</span>&gt;

&lt;com.webview.SafeWebView
    android:id=<span class="hljs-string">"@+id/web_view"</span>
    android:layout_width=<span class="hljs-string">"match_parent"</span>
    android:layout_height=<span class="hljs-string">"match_parent"</span>/&gt;
&lt;/LinearLayout&gt;

  <span class="hljs-comment">// BaseWebView 是我自己封装的 WebView </span>

  <span class="hljs-comment">//实际使用时请采用 new 的方式</span>
  mWebView = (SafeWebView) findViewById(R.id.web_view);
  mWebView.addJavascriptInterface(<span class="hljs-keyword">new</span> NativeInterface(this), <span class="hljs-string">"AndroidNative"</span>);
  mWebView.loadUrl(<span class="hljs-string">"http://www.jianshu.com/u/fa272f63280a"</span>);
</code></pre>
<hr>
<h3>三、WebView 方法</h3>
<blockquote>
<p>主要包含 WebView 的使用方法。 我们基于这些方法能扩展很多其他功能，例如：JsBridge、缓存等。</p>
</blockquote>
<h4>常用方法</h4>
<ul>
<li>void loadUrl(String url):加载网络链接 url</li>
<li>boolean canGoBack():判断 WebView 当前是否可以返回上一页</li>
<li>goBack():回退到上一页</li>
<li>boolean canGoForward():判断 WebView 当前是否可以向前一页</li>
<li>goForward():回退到前一页</li>
<li>onPause():类似 Activity 生命周期，页面进入后台不可见状态</li>
<li>pauseTimers():该方法面向全局整个应用程序的webview，它会暂停所有webview的layout，parsing，JavaScript Timer。当程序进入后台时，该方法的调用可以降低CPU功耗。</li>
<li>onResume():在调用 onPause()后，可以调用该方法来恢复 WebView 的运行。</li>
<li>resumeTimers():恢复pauseTimers时的所有操作。(注：pauseTimers和resumeTimers 方法必须一起使用，否则再使用其它场景下的 WebView 会有问题)</li>
<li>destroy():销毁 WebView</li>
<li>clearHistory():清除当前 WebView 访问的历史记录。</li>
<li>clearCache(boolean includeDiskFiles):清空网页访问留下的缓存数据。需要注意的时，由于缓存是全局的，所以只要是WebView用到的缓存都会被清空，即便其他地方也会使用到。该方法接受一个参数，从命名即可看出作用。若设为false，则只清空内存里的资源缓存，而不清空磁盘里的。</li>
<li>reload():重新加载当前请求</li>
<li>setLayerType(int layerType, Paint paint):设置硬件加速、软件加速</li>
<li>removeAllViews():清除子view。</li>
<li>clearSslPreferences():清除ssl信息。</li>
<li>clearMatches():清除网页查找的高亮匹配字符。</li>
<li>removeJavascriptInterface(String interfaceName):删除interfaceName 对应的注入对象</li>
<li>addJavascriptInterface(Object object,String interfaceName):注入 java 对象。</li>
<li>setVerticalScrollBarEnabled(boolean verticalScrollBarEnabled):设置垂直方向滚动条。</li>
<li>setHorizontalScrollBarEnabled(boolean horizontalScrollBarEnabled):设置横向滚动条。</li>
<li>loadUrl(String url, Map&lt;String, String&gt; additionalHttpHeaders):加载制定url并携带http header数据。</li>
<li>evaluateJavascript(String script, ValueCallback&lt;String&gt; resultCallback):Api 19 之后可以采用此方法之行 Js。</li>
<li>stopLoading():停止 WebView 当前加载。</li>
<li>clearView():在Android 4.3及其以上系统这个api被丢弃了， 并且这个api大多数情况下会有bug，经常不能清除掉之前的渲染数据。官方建议通过loadUrl("about:blank")来实现这个功能，阴雨需要重新加载一个页面自然时间会收到影响。</li>
<li>freeMemory():释放内存，不过貌似不好用。</li>
<li>clearFormData():清除自动完成填充的表单数据。需要注意的是，该方法仅仅清除当前表单域自动完成填充的表单数据，并不会清除WebView存储到本地的数据。</li>
</ul>
<p><strong>我这里在介绍下下面几组方法，比较重要，项目当中可能会遇到坑</strong></p>
<ul>
<li><p>onPause() 尽力尝试暂停可以暂停的任何处理，如动画和地理位置。 不会暂停JavaScript。 要全局暂停JavaScript，可使用pauseTimers。</p></li>
<li><p>onResume() 恢复onPause() 停掉的操作；</p></li>
<li><p>pauseTimers() 暂停所有WebView的布局，解析和JavaScript定时器。 这个是一个全局请求，不仅限于这个WebView。</p></li>
<li><p>resumeTimers() 恢复所有WebView的所有布局，解析和JavaScript计时器，将恢复调度所有计时器.</p></li>
</ul>
<blockquote>
<p>另外注意 JS 端setTimeout()、setInterval() 方法使用，自测来看，当不使用 pauseTimers()  和 pauseTimers() ，从 Activity 返回上一个包含WebView 的Activity时，页面里的 setTimeout() 是不执行的，setInterval() 是可以恢复执行的。</p>
</blockquote>
<p>在适当的生命周期使用 pauseTimers()  和 pauseTimers() 既可以恢复setTimeout() 执行。</p>
<h4>一份 WebView 方法使用清单</h4>
<pre class="hljs cpp"><code class="cpp">    mWebView.loadUrl(<span class="hljs-string">"http://www.jianshu.com/u/fa272f63280a"</span>);<span class="hljs-comment">// 加载url，也可以执行js函数</span>
    mWebView.setWebViewClient(<span class="hljs-keyword">new</span> SafeWebViewClient());<span class="hljs-comment">// 设置 WebViewClient </span>
    mWebView.setWebChromeClient(<span class="hljs-keyword">new</span> SafeWebChromeClient());<span class="hljs-comment">// 设置 WebChromeClient</span>
    mWebView.onResume();<span class="hljs-comment">// 生命周期onResume</span>
    mWebView.resumeTimers();<span class="hljs-comment">//生命周期resumeTimers</span>
    mWebView.onPause();<span class="hljs-comment">//生命周期onPause</span>
    mWebView.pauseTimers();<span class="hljs-comment">//生命周期pauseTimers (上数四个方法都是成对出现)</span>
    mWebView.stopLoading();<span class="hljs-comment">// 停止当前加载</span>
    mWebView.clearMatches();<span class="hljs-comment">// 清除网页查找的高亮匹配字符。</span>
    mWebView.clearHistory();<span class="hljs-comment">// 清除当前 WebView 访问的历史记录</span>
    mWebView.clearSslPreferences();<span class="hljs-comment">//清除ssl信息</span>
    mWebView.clearCache(<span class="hljs-literal">true</span>);<span class="hljs-comment">//清空网页访问留下的缓存数据。需要注意的时，由于缓存是全局的，所以只要是WebView用到的缓存都会被清空，即便其他地方也会使用到。该方法接受一个参数，从命名即可看出作用。若设为false，则只清空内存里的资源缓存，而不清空磁盘里的。</span>
    mWebView.loadUrl(<span class="hljs-string">"about:blank"</span>);<span class="hljs-comment">// 清空当前加载</span>
    mWebView.removeAllViews();<span class="hljs-comment">// 清空子 View</span>
    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR2) {
        mWebView.removeJavascriptInterface(<span class="hljs-string">"AndroidNative"</span>);<span class="hljs-comment">// 向 Web端注入 java 对象</span>
    }
    mWebView.destroy();<span class="hljs-comment">// 生命周期销毁</span>
</code></pre>
<hr>
<h3>四、常用属性</h3>
<blockquote>
<p>主要包含三部分：WebSettings、WebViewClient、WebChromeClient。</p>
</blockquote>
<h4>WebSettings</h4>
<h5>常用方法</h5>
<ul>
<li>setJavaScriptEnabled(boolean flag):是否支持 Js 使用。</li>
<li>setCacheMode(int mode):设置 WebView 的缓存模式。</li>
<li>setAppCacheEnabled(boolean flag):是否启用缓存模式。</li>
<li>setAppCachePath(String appCachePath):Android 私有缓存存储，如果你不调用setAppCachePath方法，WebView将不会产生这个目录。</li>
<li>setSupportZoom(boolean support):是否支持缩放。</li>
<li>setTextZoom(int textZoom):Sets the text zoom of the page in percent. The default is 100。</li>
<li>setAllowFileAccess(boolean allow):是否允许加载本地 html 文件/false。</li>
<li>setDatabaseEnabled(boolean flag):是否开启数据库缓存</li>
<li>setDomStorageEnabled(boolean flag):是否开启DOM缓存。</li>
<li>setUserAgentString(String ua):设置 UserAgent 属性。</li>
<li>setLoadsImagesAutomatically(boolean flag):支持自动加载图片</li>
<li>setAllowFileAccessFromFileURLs(boolean flag：:允许通过 file url 加载的 Javascript 读取其他的本地文件,Android 4.1 之前默认是true，在 Android 4.1 及以后默认是false,也就是禁止。</li>
<li>setAllowUniversalAccessFromFileURLs(boolean flag):允许通过 file url 加载的 Javascript 可以访问其他的源，包括其他的文件和 http，https 等其他的源，Android 4.1 之前默认是true，在 Android 4.1 及以后默认是false,也就是禁止如果此设置是允许，则 setAllowFileAccessFromFileURLs 不起做用。</li>
<li>boolean getLoadsImagesAutomatically():是否支持自动加载图片。</li>
</ul>
<h5>一份使用清单</h5>
<pre class="hljs java"><code class="java">    WebSettings webSettings = mWebView.getSettings();
    <span class="hljs-keyword">if</span> (webSettings == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// 支持 Js 使用</span>
    webSettings.setJavaScriptEnabled(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 开启DOM缓存</span>
    webSettings.setDomStorageEnabled(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 开启数据库缓存</span>
    webSettings.setDatabaseEnabled(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 支持自动加载图片</span>
    webSettings.setLoadsImagesAutomatically(hasKitkat());
    <span class="hljs-comment">// 设置 WebView 的缓存模式</span>
    webSettings.setCacheMode(WebSettings.LOAD_DEFAULT);
    <span class="hljs-comment">// 支持启用缓存模式</span>
    webSettings.setAppCacheEnabled(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 设置 AppCache 最大缓存值(现在官方已经不提倡使用，已废弃)</span>
    webSettings.setAppCacheMaxSize(<span class="hljs-number">8</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);
    <span class="hljs-comment">// Android 私有缓存存储，如果你不调用setAppCachePath方法，WebView将不会产生这个目录</span>
    webSettings.setAppCachePath(getCacheDir().getAbsolutePath());
    <span class="hljs-comment">// 数据库路径</span>
    <span class="hljs-keyword">if</span> (!hasKitkat()) {
        webSettings.setDatabasePath(getDatabasePath(<span class="hljs-string">"html"</span>).getPath());
    }
    <span class="hljs-comment">// 关闭密码保存提醒功能</span>
    webSettings.setSavePassword(<span class="hljs-keyword">false</span>);
    <span class="hljs-comment">// 支持缩放</span>
    webSettings.setSupportZoom(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 设置 UserAgent 属性</span>
    webSettings.setUserAgentString(<span class="hljs-string">""</span>);
    <span class="hljs-comment">// 允许加载本地 html 文件/false</span>
    webSettings.setAllowFileAccess(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// 允许通过 file url 加载的 Javascript 读取其他的本地文件,Android 4.1 之前默认是true，在 Android 4.1 及以后默认是false,也就是禁止</span>
    webSettings.setAllowFileAccessFromFileURLs(<span class="hljs-keyword">false</span>);
    <span class="hljs-comment">// 允许通过 file url 加载的 Javascript 可以访问其他的源，包括其他的文件和 http，https 等其他的源，</span>
    <span class="hljs-comment">// Android 4.1 之前默认是true，在 Android 4.1 及以后默认是false,也就是禁止</span>
    <span class="hljs-comment">// 如果此设置是允许，则 setAllowFileAccessFromFileURLs 不起做用</span>
    webSettings.setAllowUniversalAccessFromFileURLs(<span class="hljs-keyword">false</span>);
</code></pre>
<h4>WebViewClient</h4>
<h5>1、常用方法</h5>
<ul>
<li>onPageStarted(WebView view, String url, Bitmap favicon):WebView 开始加载页面时回调，一次Frame加载对应一次回调。</li>
<li>onLoadResource(WebView view, String url):WebView 加载页面资源时会回调，每一个资源产生的一次网络加载，除非本地有当前 url 对应有缓存，否则就会加载。</li>
<li>shouldInterceptRequest(WebView view, String url):WebView 可以拦截某一次的 request 来返回我们自己加载的数据，这个方法在后面缓存会有很大作用。</li>
<li>shouldInterceptRequest(WebView view, android.webkit.WebResourceRequest request):WebView 可以拦截某一次的 request 来返回我们自己加载的数据，这个方法在后面缓存会有很大作用。</li>
<li>shouldOverrideUrlLoading(WebView view, String url):是否在 WebView 内加载页面。</li>
<li>onReceivedSslError(WebView view, SslErrorHandler handler, SslError error):WebView ssl 访问证书出错，handler.cancel()取消加载，handler.proceed()对然错误也继续加载。</li>
<li>onPageFinished(WebView view, String url):WebView 完成加载页面时回调，一次Frame加载对应一次回调。</li>
<li>onReceivedError(WebView view, int errorCode, String description, String failingUrl):WebView 访问 url 出错。</li>
</ul>
<h5>2、一份使用清单</h5>
<pre class="hljs java"><code class="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafeWebViewClient</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebViewClient</span> </span>{

    <span class="hljs-comment">/**
     * 当WebView得页面Scale值发生改变时回调
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onScaleChanged</span><span class="hljs-params">(WebView view, <span class="hljs-keyword">float</span> oldScale, <span class="hljs-keyword">float</span> newScale)</span> </span>{
        <span class="hljs-keyword">super</span>.onScaleChanged(view, oldScale, newScale);
    }

    <span class="hljs-comment">/**
     * 是否在 WebView 内加载页面
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">shouldOverrideUrlLoading</span><span class="hljs-params">(WebView view, String url)</span> </span>{
        view.loadUrl(url);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }

    <span class="hljs-comment">/**
     * WebView 开始加载页面时回调，一次Frame加载对应一次回调
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     * <span class="hljs-doctag">@param</span> favicon
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPageStarted</span><span class="hljs-params">(WebView view, String url, Bitmap favicon)</span> </span>{
        <span class="hljs-keyword">super</span>.onPageStarted(view, url, favicon);
    }

    <span class="hljs-comment">/**
     * WebView 完成加载页面时回调，一次Frame加载对应一次回调
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPageFinished</span><span class="hljs-params">(WebView view, String url)</span> </span>{
        <span class="hljs-keyword">super</span>.onPageFinished(view, url);
    }

    <span class="hljs-comment">/**
     * WebView 加载页面资源时会回调，每一个资源产生的一次网络加载，除非本地有当前 url 对应有缓存，否则就会加载。
     *
     * <span class="hljs-doctag">@param</span> view WebView
     * <span class="hljs-doctag">@param</span> url  url
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onLoadResource</span><span class="hljs-params">(WebView view, String url)</span> </span>{
        <span class="hljs-keyword">super</span>.onLoadResource(view, url);
    }

    <span class="hljs-comment">/**
     * WebView 可以拦截某一次的 request 来返回我们自己加载的数据，这个方法在后面缓存会有很大作用。
     *
     * <span class="hljs-doctag">@param</span> view    WebView
     * <span class="hljs-doctag">@param</span> request 当前产生 request 请求
     * <span class="hljs-doctag">@return</span> WebResourceResponse
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> WebResourceResponse <span class="hljs-title">shouldInterceptRequest</span><span class="hljs-params">(WebView view, WebResourceRequest request)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.shouldInterceptRequest(view, request);
    }

    <span class="hljs-comment">/**
     * WebView 访问 url 出错
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> request
     * <span class="hljs-doctag">@param</span> error
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onReceivedError</span><span class="hljs-params">(WebView view, WebResourceRequest request, WebResourceError error)</span> </span>{
        <span class="hljs-keyword">super</span>.onReceivedError(view, request, error);
    }

    <span class="hljs-comment">/**
     * WebView ssl 访问证书出错，handler.cancel()取消加载，handler.proceed()对然错误也继续加载
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> handler
     * <span class="hljs-doctag">@param</span> error
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onReceivedSslError</span><span class="hljs-params">(WebView view, SslErrorHandler handler, SslError error)</span> </span>{
        <span class="hljs-keyword">super</span>.onReceivedSslError(view, handler, error);
    }
}
</code></pre>
<h4>WebChromeClient</h4>
<h5>1、常用方法</h5>
<ul>
<li>onConsoleMessage(String message, int lineNumber,String sourceID):输出 Web 端日志。</li>
<li>onProgressChanged(WebView view, int newProgress):当前 WebView 加载网页进度。</li>
<li>onJsPrompt(WebView view, String url, String message, String defaultValue, JsPromptResult result):处理 JS 中的 Prompt对话框</li>
<li>onJsAlert(WebView view, String url, String message, JsResult result): Js 中调用 alert() 函数，产生的对话框。</li>
<li>onReceivedTitle(WebView view, String title):接收web页面的 Title。</li>
<li>onReceivedIcon(WebView view, Bitmap icon):接收web页面的icon。</li>
</ul>
<h5>2、一份使用清单</h5>
<pre class="hljs java"><code class="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafeWebChromeClient</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebChromeClient</span> </span>{

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onConsoleMessage</span><span class="hljs-params">(ConsoleMessage consoleMessage)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onConsoleMessage(consoleMessage);
    }

    <span class="hljs-comment">/**
     * 当前 WebView 加载网页进度
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> newProgress
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onProgressChanged</span><span class="hljs-params">(WebView view, <span class="hljs-keyword">int</span> newProgress)</span> </span>{
        <span class="hljs-keyword">super</span>.onProgressChanged(view, newProgress);
    }

    <span class="hljs-comment">/**
     * Js 中调用 alert() 函数，产生的对话框
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     * <span class="hljs-doctag">@param</span> message
     * <span class="hljs-doctag">@param</span> result
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onJsAlert</span><span class="hljs-params">(WebView view, String url, String message, JsResult result)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onJsAlert(view, url, message, result);
    }

    <span class="hljs-comment">/**
     * 处理 Js 中的 Confirm 对话框
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     * <span class="hljs-doctag">@param</span> message
     * <span class="hljs-doctag">@param</span> result
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onJsConfirm</span><span class="hljs-params">(WebView view, String url, String message, JsResult result)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onJsConfirm(view, url, message, result);
    }

    <span class="hljs-comment">/**
     * 处理 JS 中的 Prompt对话框
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> url
     * <span class="hljs-doctag">@param</span> message
     * <span class="hljs-doctag">@param</span> defaultValue
     * <span class="hljs-doctag">@param</span> result
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onJsPrompt</span><span class="hljs-params">(WebView view, String url, String message, String defaultValue, JsPromptResult result)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onJsPrompt(view, url, message, defaultValue, result);
    }

    <span class="hljs-comment">/**
     * 接收web页面的icon
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> icon
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onReceivedIcon</span><span class="hljs-params">(WebView view, Bitmap icon)</span> </span>{
        <span class="hljs-keyword">super</span>.onReceivedIcon(view, icon);
    }

    <span class="hljs-comment">/**
     * 接收web页面的 Title
     *
     * <span class="hljs-doctag">@param</span> view
     * <span class="hljs-doctag">@param</span> title
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onReceivedTitle</span><span class="hljs-params">(WebView view, String title)</span> </span>{
        <span class="hljs-keyword">super</span>.onReceivedTitle(view, title);
    }

}
</code></pre>
<hr>
<h3>五、于 JavaScript 交互</h3>
<h4>介绍</h4>
<blockquote>
<p>注：这里着重介绍下第一种标准方式，后面会介绍其他两种方式。</p>
</blockquote>
<p>1、使用系统方法 addJavascriptInterface 注入 java 对象来实现。</p>
<p>2、利用 WebViewClient 中 shouldOverrideUrlLoading (WebView view, String url) 接口，拦截操作。这个就是很多公司在用的 scheme  方式，通过制定url协议，双方各自解析，使用iframe来调用native代码，实现互通。</p>
<p>3、利用 WebChromeClient 中的 onJsAlert、onJsConfirm、onJsPrompt 提示接口，同样也是拦截操作。</p>
<h4>使用清单：</h4>
<pre class="hljs php"><code class="php"><span class="hljs-comment">//开启Js可用</span>
mWebView.getSettings().setJavaScriptEnabled(<span class="hljs-keyword">true</span>);

<span class="hljs-comment">// 创建要注入的 Java 类</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NativeInterface</span> </span>{

    <span class="hljs-keyword">private</span> Context mContext;

    <span class="hljs-keyword">public</span> NativeInterface(Context context) {
        mContext = context;
    }

    @JavascriptInterface
    <span class="hljs-keyword">public</span> void hello() {
        Toast.makeText(mContext, <span class="hljs-string">"hello"</span>, Toast.LENGTH_SHORT).show();
    }

    @JavascriptInterface
    <span class="hljs-keyword">public</span> void hello(String params) {
        Toast.makeText(mContext, params, Toast.LENGTH_SHORT).show();
    }

    @JavascriptInterface
    <span class="hljs-keyword">public</span> String getAndroid() {
        Toast.makeText(mContext, <span class="hljs-string">"getAndroid"</span>, Toast.LENGTH_SHORT).show();
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Android data"</span>;
    }

}

<span class="hljs-comment">// WebView 注入即可</span>
mWebView.addJavascriptInterface(<span class="hljs-keyword">new</span> NativeInterface(this), <span class="hljs-string">"AndroidNative"</span>);

<span class="hljs-comment">//Js编写</span>
&lt;script&gt;
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callHello</span><span class="hljs-params">()</span></span>{
        AndroidNative.hello();
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callHello1</span><span class="hljs-params">()</span></span>{
        AndroidNative.hello(<span class="hljs-string">'hello Android'</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callAndroid</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">var</span> temp = AndroidNative.getAndroid();
        console.log(temp);
        alert(temp);
    }  

&lt;/script&gt;
</code></pre>
<p>Native 调用 Js：mWebView.loadUrl(js);</p>
<p>Js 调用 Native :AndroidNative.getAndroid();</p>
<blockquote>
<p>4.2版本以下会存在漏洞，4.2以上需要添加 @JavascriptInterface 注解才能被调用到，Js 调用方式不变。</p>
</blockquote>
<hr>
<h3>六、Js 注入漏洞</h3>
<blockquote>
<p>虽然可以通过注入方式来实现 WebView 和 JS 交互，但是实现功能的同时也带了安全问题，通过注入的 Java 类作为桥梁，JS 就可以利用这个漏洞。</p>
</blockquote>
<h4>常见漏洞</h4>
<p>目前已知的 WebView 漏洞有 4 个,分别是：</p>
<p>1、<a href="https://link.jianshu.com/?t=https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6636" target="_blank" rel="nofollow">CVE-2012-6636</a>，揭露了 WebView 中 addJavascriptInterface 接口会引起远程代码执行漏洞；<br>
2、<a href="https://link.jianshu.com/?t=https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4710" target="_blank" rel="nofollow">CVE-2013-4710</a>，针对某些特定机型会存在 addJavascriptInterface API 引起的远程代码执行漏洞；<br>
3、<a href="https://link.jianshu.com/?t=https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1939" target="_blank" rel="nofollow">CVE-2014-1939</a> 爆出 WebView 中内置导出的 “searchBoxJavaBridge_” Java Object 可能被利用，实现远程任意代码；<br>
4、<a href="https://link.jianshu.com/?t=CVE-2014-7224" target="_blank" rel="nofollow">CVE-2014-7224</a>，类似于 CVE-2014-1939 ，WebView 内置导出 “accessibility” 和 “accessibilityTraversal” 两个 Java Object 接口，可被利用实现远程任意代码执行。</p>
<h4>如何解决漏洞</h4>
<p>1、Android 4.2 以下不要在使用 JavascriptInterface方式，4.2 以上需要添加注解 @JavascriptInterface 才能调用。（这部分和JsBrige 有关，更详细的内容后面会介绍）</p>
<p>2、同1解决；</p>
<p>3、在创建 WebView 时，使用 removeJavascriptInterface 方法将系统注入的 searchBoxJavaBridge_ 对象删除。</p>
<p>4、当系统辅助功能服务被开启时，在 Android 4.4 以下的系统中，由系统提供的 WebView 组件都默认导出 ”accessibility” 和 ”accessibilityTraversal” 这两个接口，这两个接口同样存在远程任意代码执行的威胁，同样的需要通过 removeJavascriptInterface 方法将这两个对象删除。</p>
<pre class="hljs java"><code class="java">       <span class="hljs-keyword">super</span>.removeJavascriptInterface(<span class="hljs-string">"searchBoxJavaBridge_"</span>);
       <span class="hljs-keyword">super</span>.removeJavascriptInterface(<span class="hljs-string">"accessibility"</span>);
       <span class="hljs-keyword">super</span>.removeJavascriptInterface(<span class="hljs-string">"accessibilityTraversal"</span>);
</code></pre>
<p>以上都是系统机制层面上的漏洞，还有一些是使用 WebView 不挡产生的漏洞。</p>
<p>5、通过 WebSettings.setSavePassword(false) 关闭密码保存提醒功能，防止明文密码存在本地被盗用。</p>
<p>6、WebView 默认是可以使用 File 协议的，也就是 setAllowFileAccess(true)，我们应该是主动设置为 setAllowFileAccess(false),防止加载本地文件，移动版的 Chrome 默认禁止加载 file 协议的文件</p>
<pre class="hljs ruby"><code class="ruby">setAllowFileAccess(<span class="hljs-literal">true</span>);<span class="hljs-regexp">//</span>设置为 <span class="hljs-literal">false</span> 将不能加载本地 html 文件
setAllowFileAccessFromFileURLs(<span class="hljs-literal">false</span>);
setAllowUniversalAccessFromFileURLs(<span class="hljs-literal">false</span>);
<span class="hljs-keyword">if</span> (url.startsWith(<span class="hljs-string">"file://"</span>) {
    setJavaScriptEnabled(<span class="hljs-literal">false</span>);
} <span class="hljs-keyword">else</span> {
    setJavaScriptEnabled(<span class="hljs-literal">true</span>);
}
</code></pre>
<h4>安全修复案例</h4>
<p>推荐 <a href="https://link.jianshu.com/?t=https://github.com/seven456/SafeWebView" target="_blank" rel="nofollow">SafeWebView</a> 这个库中解决了 Android WebView 中 Js 注入漏洞问题，另外还包含了一些异常处理。可以自行下载阅读源码。</p>
<hr>
<h3>七、一些坑</h3>
<blockquote>
<p>主要总结 WebView 相关的疑难 bug，由于 Android 版本严重碎片化，在使用 WebView 的时候也会遇到各种个样的坑，特别是 4.4 之后更换了 WebView 内核，4.2 以下有部分漏洞，所以想把经历过的 WebView 这些坑记录下来，仅供参考。</p>
</blockquote>
<h4>1、android.webkit.AccessibilityInjector$TextToSpeechWrapper</h4>
<pre class="hljs bash"><code class="bash">java.lang.NullPointerException
    at android.webkit.AccessibilityInjector<span class="hljs-variable">$TextToSpeechWrapper</span><span class="hljs-variable">$1</span>.onInit(AccessibilityInjector.java:753)
    at android.speech.tts.TextToSpeech.dispatchOnInit(TextToSpeech.java:640)
    at android.speech.tts.TextToSpeech.initTts(TextToSpeech.java:619)
    at android.speech.tts.TextToSpeech.&lt;init&gt;(TextToSpeech.java:553)
    at android.webkit.AccessibilityInjector<span class="hljs-variable">$TextToSpeechWrapper</span>.&lt;init&gt;(AccessibilityInjector.java:676)
    at android.webkit.AccessibilityInjector.addTtsApis(AccessibilityInjector.java:480)
    at android.webkit.AccessibilityInjector.addAccessibilityApisIfNecessary(AccessibilityInjector.java:168)
    at android.webkit.AccessibilityInjector.onPageStarted(AccessibilityInjector.java:340)
    at android.webkit.WebViewClassic.onPageStarted(WebViewClassic.java:4480)
    at android.webkit.CallbackProxy.handleMessage(CallbackProxy.java:366)
    at android.os.Handler.dispatchMessage(Handler.java:107)
    at android.os.Looper.loop(Looper.java:194)
    at android.app.ActivityThread.main(ActivityThread.java:5407)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:525)
    at com.android.internal.os.ZygoteInit<span class="hljs-variable">$MethodAndArgsCaller</span>.run(ZygoteInit.java:833)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
    at dalvik.system.NativeStart.main(Native Method)
</code></pre>
<p>此问题在4.2.1和4.2.2比较集中，关闭辅助功能，google 下很多结果都是一样的。</p>
<p>修复方法：在初始化 WebView 时调用disableAccessibility方法即可。</p>
<pre class="hljs java"><code class="java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">disableAccessibility</span><span class="hljs-params">(Context context)</span> </span>{
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT == <span class="hljs-number">17</span><span class="hljs-comment">/*4.2 (Build.VERSION_CODES.JELLY_BEAN_MR1)*/</span>) {
            <span class="hljs-keyword">if</span> (context != <span class="hljs-keyword">null</span>) {
                <span class="hljs-keyword">try</span> {
                    AccessibilityManager am = (AccessibilityManager) context.getSystemService(Context.ACCESSIBILITY_SERVICE);
                    <span class="hljs-keyword">if</span> (!am.isEnabled()) {
                        <span class="hljs-comment">//Not need to disable accessibility</span>
                        <span class="hljs-keyword">return</span>;
                    }

                    Method setState = am.getClass().getDeclaredMethod(<span class="hljs-string">"setState"</span>, <span class="hljs-keyword">int</span>.class);
                    setState.setAccessible(<span class="hljs-keyword">true</span>);
                    setState.invoke(am, <span class="hljs-number">0</span>);<span class="hljs-comment">/**{<span class="hljs-doctag">@link</span> AccessibilityManager#STATE_FLAG_ACCESSIBILITY_ENABLED}*/</span>
                } <span class="hljs-keyword">catch</span> (Exception ignored) {
                    ignored.printStackTrace();
                }
            }
        }
    }
</code></pre>
<h4>2、android.content.pm.PackageManager$NameNotFoundException</h4>
<pre class="hljs xml"><code class="xml">AndroidRuntimeException: android.content.pm.PackageManager$NameNotFoundException: com.google.android.webview
    at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4604)
    at android.app.ActivityThread.access$1500(ActivityThread.java:154)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1389)
    at android.os.Handler.dispatchMessage(Handler.java:102)
    at android.os.Looper.loop(Looper.java:135)
    at android.app.ActivityThread.main(ActivityThread.java:5302)
    at java.lang.reflect.Method.invoke(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:372)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:916)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:711)
Caused by: android.util.AndroidRuntimeException: android.content.pm.PackageManager$NameNotFoundException: com.google.android.webview
    at android.webkit.WebViewFactory.getFactoryClass(WebViewFactory.java:174)
    at android.webkit.WebViewFactory.getProvider(WebViewFactory.java:109)
    at android.webkit.WebView.getFactory(WebView.java:2194)
    at android.webkit.WebView.ensureProviderCreated(WebView.java:2189)
    at android.webkit.WebView.setOverScrollMode(WebView.java:2248)
    at android.view.View.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(View.java:3588)
    at android.view.View.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(View.java:3682)
    at android.view.ViewGroup.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(ViewGroup.java:497)
    at android.widget.AbsoluteLayout.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(AbsoluteLayout.java:55)
    at android.webkit.WebView.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(WebView.java:544)
    at android.webkit.WebView.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(WebView.java:489)
    at android.webkit.WebView.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(WebView.java:472)
    at android.webkit.WebView.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(WebView.java:459)
    at android.webkit.WebView.<span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(WebView.java:449)
</code></pre>
<p>现象：在创建 WebView 时崩溃，跟进栈信息，我们需要在 setOverScrollMode 方法上加异常保护处理</p>
<p>修复方法：</p>
<pre class="hljs java"><code class="java"><span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">super</span>.setOverScrollMode(mode);
} <span class="hljs-keyword">catch</span> (Throwable e) {
    e.printStackTrace();
}  
</code></pre>
<p>不过上面捕获的异常范围有点广，在github上找到一个更全面的修复方法</p>
<pre class="hljs javascript"><code class="javascript"><span class="hljs-keyword">try</span>{
    <span class="hljs-keyword">super</span>.setOverScrollMode(mode);
} <span class="hljs-keyword">catch</span>(Throwable e){
        <span class="hljs-built_in">String</span> messageCause = e.getCause() == <span class="hljs-literal">null</span> ? e.toString() : e.getCause().toString();
<span class="hljs-built_in">String</span> trace = Log.getStackTraceString(e);
<span class="hljs-keyword">if</span> (trace.contains(<span class="hljs-string">"android.content.pm.PackageManager$NameNotFoundException"</span>)
  || trace.contains(<span class="hljs-string">"java.lang.RuntimeException: Cannot load WebView"</span>)
    || trace.contains(<span class="hljs-string">"android.webkit.WebViewFactory$MissingWebViewPackageException: Failed to load WebView provider: No WebView installed"</span>)) {
      e.printStackTrace();
    }<span class="hljs-keyword">else</span>{
      <span class="hljs-keyword">throw</span> e;
    }        
}
</code></pre>
<h4>3、android.webkit.WebViewClassic.clearView</h4>
<pre class="hljs bash"><code class="bash">at android.webkit.BrowserFrame.nativeLoadUrl(Native Method)
System.err:     at android.webkit.BrowserFrame.loadUrl(BrowserFrame.java:279)
System.err:     at android.webkit.WebViewCore.loadUrl(WebViewCore.java:2011)
System.err:     at android.webkit.WebViewCore.access<span class="hljs-variable">$1900</span>(WebViewCore.java:57)
System.err:     at android.webkit.WebViewCore<span class="hljs-variable">$EventHub</span><span class="hljs-variable">$1</span>.handleMessage(WebViewCore.java:1303)
System.err:     at android.os.Handler.dispatchMessage(Handler.java:99)
System.err:     at android.os.Looper.loop(Looper.java:137)
System.err:     at android.webkit.WebViewCore<span class="hljs-variable">$WebCoreThread</span>.run(WebViewCore.java:812)
System.err:     at java.lang.Thread.run(Thread.java:856)
webcoreglue: *** Uncaught exception returned from Java call!
System.err: java.lang.NullPointerException
System.err:     at android.webkit.WebViewClassic.clearView(WebViewClassic.java:2868)
System.err:     at android.webkit.WebViewCore.setupViewport(WebViewCore.java:2497)
System.err:     at android.webkit.WebViewCore.updateViewport(WebViewCore.java:2479)
System.err:     at android.webkit.BrowserFrame.nativeLoadUrl(Native Method)
System.err:     at android.webkit.BrowserFrame.loadUrl(BrowserFrame.java:279)
System.err:     at android.webkit.WebViewCore.loadUrl(WebViewCore.java:2011)
System.err:     at android.webkit.WebViewCore.access<span class="hljs-variable">$1900</span>(WebViewCore.java:57)
System.err:     at android.webkit.WebViewCore<span class="hljs-variable">$EventHub</span><span class="hljs-variable">$1</span>.handleMessage(WebViewCore.java:1303)
System.err:     at android.os.Handler.dispatchMessage(Handler.java:99)
System.err:     at android.os.Looper.loop(Looper.java:137)
</code></pre>
<p>这个bug是在某些设备上发生的，是在调用webView.destroy() 之前调用了loadurl操作发生的，也不是毕现问题，所以只能跟进源码查看，<br>
在清空 webview destroy 时，调用清理方法，内部可能时机有问题，会出现，WebViewClassic 中 mWebViewCore 对象为null，其内部为handler消息机制。</p>
<p>修复方法：</p>
<pre class="hljs java"><code class="java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">logdUrl</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String url)</span> </span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">super</span>.loadUrl(url);
    } <span class="hljs-keyword">catch</span> (NullPointerException e) {
        e.printStackTrace();
    }
}
</code></pre>
<hr>
<h3>八、JSBridge</h3>
<blockquote>
<p>相信很多都或多或少的了解 JsBridge,不管是 iOS 平台还是 Android平台，特别是 Hybrid 应用，肯定是要用的 JsBridge 这个机制来建立 Native 和 Web 端的通信。</p>
</blockquote>
<p>本部分简单阐述下 JsBridge 原理，以及分析两个实际案例。</p>
<h4>JsBridge 介绍：</h4>
<p>JSBridge 我们可以比喻成一座桥或者一根管道，一端是 Web一端是 Native。我们搭建这个通道的目的就是让 Native 和 Web 之间互相调用更为方便统一和简洁。<br>
JSBridge 做得好的一个典型就是微信，微信给开发者提供了 JSSDK，该SDK中暴露了很多微信native层的方法，比如支付，定位等。使用起来非常方便。</p>
<h4>JsBridge 原理：</h4>
<p>前面我们分析了 WebView 如何于 JavaScript 交互的，JSBridge 就是在这些基础之上做扩展使它支持更复杂的功能，三种形式两种原理分析如下：</p>
<p>1、使用 addJavascriptInterface</p>
<p>原理：这是Android提供的Js与Native通信的官方解决方案，将 java 对象注入到 Js 中直接作为window的某一变量来使用。</p>
<p>2、WebViewClient 中 shouldOverrideUrlLoading (WebView view, String url)。</p>
<p>利用 scheme iframe 机制，只要有iframe 加载，shouldOverrideUrlLoading 方法就会有回调。可以构造一个特殊格式的url，使用shouldOverrideUrlLoading 方法拦截url，根据解析url来之行native方法逻辑。</p>
<p>3、利用 WebChromeClient 中的 onJsAlert、onJsConfirm、onJsPrompt 提示接口，同样也是拦截操作。</p>
<p>利用 js调用window对象的对应的方法，即 window.alert，window.confirm，window.prompt，WebChromeClient 对象中的三个方法 onJsAlert、onJsConfirm、onJsPrompt 就会被触发，有了js到native的通道，那么我们就可以制定协议来约束对方。最终我们选择使用 prompt 方法，onJsPrompt()方法的message参数的值正是Js的方法window.prompt()的message的值。</p>
<p>汇总：后面两种虽然形式不同，但是原理是相同的，都是对url或者参数做文章，通过制定参数协议，不管是url还是message，到native拦截处理。native 调用 Js 只有一种方式，就是使用loadUrl(js),js 为在web端定义好的javascript 函数。</p>
<p>以上就是所有 JsBridge 的原理，自己可以写给demo跑一下，下面看几个问题：</p>
<p>1、如何避免 JS、Android、iOS 相互调用时，需要事先“约定”方法名称和参数？<br>
2、原生调用 JS 方法，能否类似原生开发一样，使用 Callback（block） 做为回调方式？<br>
3、JS 调用原生能否使用 function 获得返回值?</p>
<p>问题来源于网络，基本上都是这几个疑问，下面我们带着疑问去分析三个个方案。</p>
<h4>JsBridge 案例：</h4>
<h5>一、 <a href="https://link.jianshu.com/?t=https://tech.youzan.com/jsbridge" target="_blank" rel="nofollow">H5与Native交互之JSBridge技术</a>
</h5>
<blockquote>
<p>本案例为有赞技术团队博客分享的H5与Native交互之JSBridge技术，并没有最终完全的代码，不过很清楚的分析了IOS和Android与Javascript的底层交互原理。</p>
</blockquote>
<p>1、<strong>实现原理</strong></p>
<p>通过schema方式，使用shouldOverrideUrlLoading方法对url协议进行解析。</p>
<pre class="hljs javascript"><code class="javascript"><span class="hljs-keyword">var</span> url = <span class="hljs-string">'jsbridge://doAction?title=分享标题&amp;desc=分享描述&amp;link=http%3A%2F%2Fwww.baidu.com'</span>;  
<span class="hljs-keyword">var</span> iframe = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>);  
iframe.style.width = <span class="hljs-string">'1px'</span>;  
iframe.style.height = <span class="hljs-string">'1px'</span>;  
iframe.style.display = <span class="hljs-string">'none'</span>;  
iframe.src = url;  
<span class="hljs-built_in">document</span>.body.appendChild(iframe);  
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{  
    iframe.remove();
}, <span class="hljs-number">100</span>);
</code></pre>
<p>可以到看有赞技术是通过自定义url协议来作为传输媒介，这样 Android 就可以拦截这个请求，从而解析出相应的方法和参数</p>
<p>不过此 url 中的参数是以键值对的方式传递，我是建议使用 Json 作为传输参数比较好，灵活清楚。</p>
<p>2、<strong>库的封装</strong></p>
<p>有赞将 Js与 Native 通讯封装了一个通用的方法，我这里直接复制过来分析下：</p>
<pre class="hljs javascript"><code class="javascript">YouzanJsBridge = {  
    <span class="hljs-attr">doCall</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">functionName, data, callback</span>) </span>{
        <span class="hljs-keyword">var</span> _this = <span class="hljs-keyword">this</span>;
        <span class="hljs-comment">// 解决连续调用问题</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.lastCallTime &amp;&amp; (<span class="hljs-built_in">Date</span>.now() - <span class="hljs-keyword">this</span>.lastCallTime) &lt; <span class="hljs-number">100</span>) {
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                _this.doCall(functionName, data, callback);
            }, <span class="hljs-number">100</span>);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">this</span>.lastCallTime = <span class="hljs-built_in">Date</span>.now();

        data = data || {};
        <span class="hljs-keyword">if</span> (callback) {
            $.extend(data, { <span class="hljs-attr">callback</span>: callback });
        }

        <span class="hljs-keyword">if</span> (UA.isIOS()) {
            $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
                <span class="hljs-keyword">if</span> ($.isPlainObject(value) || $.isArray(value)) {
                    data[key] = <span class="hljs-built_in">JSON</span>.stringify(value);
                }
            });
            <span class="hljs-keyword">var</span> url = Args.addParameter(<span class="hljs-string">'youzanjs://'</span> + functionName, data);
            <span class="hljs-keyword">var</span> iframe = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>);
            iframe.style.width = <span class="hljs-string">'1px'</span>;
            iframe.style.height = <span class="hljs-string">'1px'</span>;
            iframe.style.display = <span class="hljs-string">'none'</span>;
            iframe.src = url;
            <span class="hljs-built_in">document</span>.body.appendChild(iframe);
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                iframe.remove();
            }, <span class="hljs-number">100</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (UA.isAndroid()) {
            <span class="hljs-built_in">window</span>.androidJS &amp;&amp; <span class="hljs-built_in">window</span>.androidJS[functionName] &amp;&amp; <span class="hljs-built_in">window</span>.androidJS[functionName](<span class="hljs-built_in">JSON</span>.stringify(data));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'未获取platform信息，调取api失败'</span>);
        }
    }
}
</code></pre>
<p>这样不管是和iOS通信还是 Android，都只需要调用 YouzanJsBridge.doCall() 方法即可，讲两个平台的不同屏蔽在封装基础上，这样也有利于 Web 端代码的整洁和代码兼容。</p>
<p>当然这里的Android 平台是没有 callback 回调的，如果你想实现两端互调的机制，请参考下一个案例，里面会详细介绍这部分。</p>
<p>3、<strong>一些优化</strong></p>
<p>将项目通用方法抽象</p>
<p>例如：</p>
<p>1.getData(datatype, callback, extra) H5从Native APP获取数据<br>
使用场景：H5需要从Native APP获取某些数据的时候，可以调用这个方法。</p>
<p>2.putData(datatype, data) H5告诉Native APP一些数据<br>
使用场景：H5告诉Native APP一些数据，可以调用这个方法。</p>
<p>3.gotoWebview(url, page, data) Native APP新开一个Webview窗口，并打开相应网页</p>
<p>4.doAction(action, data) 功能上的一些操作</p>
<p>等等其他方法，我相信如果你自己写过 native和js 调用demo，上面抽象出来的方法并不陌生，所以，如果你的业务没有那么复杂，没有像微信那样，需要提供给数以万计开发者去用去扩展，这种抽象出一些通用方法的方式不是为一种节省成本，快速迭代，方便的方式。</p>
<p>小结：总之万变不离其宗，所有封装或者框架的东西，使用的东西都还是最基本的方法，只是对基础做一个什么样程度扩展，或深或浅，唯一的只要用着舒服就行。</p>
<h5>二：<a href="https://link.jianshu.com/?t=https://github.com/lzyzsd/JsBridge" target="_blank" rel="nofollow">JsBridge</a>
</h5>
<p><strong>1、使用方法:</strong></p>
<blockquote>
<p>注意Android 和 Web 使用方式</p>
</blockquote>
<pre class="hljs javascript"><code class="javascript">webView.registerHandler(<span class="hljs-string">"submitFromWeb"</span>, <span class="hljs-keyword">new</span> BridgeHandler() {

    @Override
    public <span class="hljs-keyword">void</span> handler(<span class="hljs-built_in">String</span> data, CallBackFunction <span class="hljs-function"><span class="hljs-keyword">function</span>) </span>{
      <span class="hljs-function"><span class="hljs-keyword">function</span>.<span class="hljs-title">onCallBack</span>(<span class="hljs-params"><span class="hljs-string">"native submitFromWeb 方法, 返回 data"</span></span>);
    }
  });

  <span class="hljs-title">webView</span>.<span class="hljs-title">callHandler</span>(<span class="hljs-params"><span class="hljs-string">"functionInJs"</span>, new Gson(</span>).<span class="hljs-title">toJson</span>(<span class="hljs-params">user</span>), <span class="hljs-title">new</span> <span class="hljs-title">CallBackFunction</span>(<span class="hljs-params"></span>) </span>{
    @Override
    public <span class="hljs-keyword">void</span> onCallBack(<span class="hljs-built_in">String</span> data) {
      Log.i(TAG, <span class="hljs-string">"onCallBack : "</span> + data);
    }
  });

  <span class="hljs-built_in">window</span>.WebViewJavascriptBridge.callHandler(
      <span class="hljs-string">'submitFromWeb'</span>
      , {<span class="hljs-string">'param'</span>: <span class="hljs-string">'中文测试'</span>}
            , <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">responseData</span>) </span>{
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"show"</span>).innerHTML = <span class="hljs-string">"send get responseData from Android 端, data = "</span> + responseData
  }
        );

  bridge.registerHandler(<span class="hljs-string">"functionInJs"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, responseCallback</span>) </span>{
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"show"</span>).innerHTML = (<span class="hljs-string">"data from Java: = "</span> + data);
    <span class="hljs-keyword">var</span> responseData = <span class="hljs-string">"call functionInJs success,return android!"</span>;
    responseCallback(responseData);
  });
</code></pre>
<p><strong>2、关键类作用：</strong></p>
<blockquote>
<p>在讲 JsBridge 的实现之前，首先要讲下各个文件的作用</p>
</blockquote>
<ul>
<li>Message.java:JsBridge 中的消息对象，用来封装native与js交互时的json数据，包含：callid、responseid、responseData、handlerName等字段。</li>
<li>WebViewJavascriptBridge.js:改js文件会被注入到各个页面，和native中封装处理Message消息逻辑类似，同样提供了初始化、注册Handler、调用Handler等方法，之后js都是通过此文件中的方法和native统一沟通。</li>
<li>WebViewJavascriptBridge.java:native 端，Bridge接口类,定义了发送信息的方法，由BridgeWebView来实现，之后调用可以通过webview.send()方式调用。</li>
<li>BridgeWebView.java:WebView的子类，实现了WebViewJavascriptBridge接口，并提供了注册、调用 Handler等方法，之后都是通过webview.registerHandler()或者webview.callHandler()方式调用js.</li>
<li>BridgeWebViewClient.java:WebViewClient的子类，重写了ShouldOverrideUrlLoading，onPageFinish，onPageStart等方法。</li>
<li>BridgeHandler.java:作为native与web交互的通道。native通过Handler的名称来找到响应的Handler来操作，这样才能实现js回调给native端，也就是registerHandler时候注册的监听。</li>
<li>CallBackFunction.java:native定义的回调函数， Handler处理完成后，用来给Js发送消息，对应处理js中function中。</li>
</ul>
<p><strong>3、实现原理：</strong></p>
<p>看完这些主要类的作用，在看流程就清晰了。</p>
<p>native 调 js：</p>
<p>1、WebView.callHandler('handlerName','{}',callBack);<br>
2、doSend 中组装 要传输的 Message 对象，并设置setCallbackId（生成唯一的id是为了方便在js回调回来的时候在android端查找对于的 callback）<br>
3、dispatchMessage javascript:WebViewJavascriptBridge._handleMessageFromNative(message);方法 message 为上一步的Message 对象对应的 Json 数据。<br>
4、在 Js _dispatchMessageFromNative 函数中，根据 messageJSON json 数据中的字段 handlerName 找到对对应的 handler 方法执行。<br>
handler = messageHandlers[message.handlerName];handler 这个就是在 html 中 registerHandler 注册的回调function(data, responseCallback)函数<br>
5、之后执行 html 中 responseCallback(responseData); 会触发 WebViewJavascriptBridge.js 文件中的 _doSend函数，_doSend 通过 messagingIframe.src 形式传给 android端，shouldOverrideUrlLoading 接受，并拦截内容处理。<br>
6、第一次：拦截执行到 webView.flushMessageQueue()方法，并调用 responseCallbacks.put(jsUrl,returnCallback);，同时调用 javascript:WebViewJavascriptBridge._fetchQueue(); 来查询消息的返回值，并执行一次messagingIframe.src。<br>
7、第二次：拦截执行到 webView.handlerReturnData() 方法，并调用上一步注册的 CallBackFunction.onCallBack，然后根据responseId 即 android 传过来的 message.callbackId，找到 使用者注册的 CallBackFunction 回调。</p>
<p>本次的流程就走完了,看几十遍就看懂了哈。</p>
<p>Js -&gt; android:</p>
<p>1、window.WebViewJavascriptBridge.callHandler<br>
2、执行 Js 函数 _doSend() 触发 messagingIframe.src<br>
3、android 端拦截，shouldOverrideUrlLoading<br>
4、第一次：拦截执行到 webView.flushMessageQueue()方法，并调用 responseCallbacks.put(jsUrl,returnCallback);，同时调用 javascript:WebViewJavascriptBridge._fetchQueue(); 来查询消息的返回值，并执行一次messagingIframe.src。<br>
5、第二次：拦截执行到 webView.handlerReturnData() 方法，并调用上一步注册的 CallBackFunction.onCallBack -&gt; responseId 为空 -&gt; handler.handler(m.getData(), responseFunction)-&gt; 外部回调（ function.onCallBack("native submitFromWeb 方法, 返回 data");）-&gt; queueMessage -&gt; dispatchMessage -&gt;loadUrl(javascriptCommand) -&gt; 回调结束</p>
<blockquote>
<p>注意两端的每一次通讯，Android 端的 shouldOverrideUrlLoading 方法都会执行两次，但是携带url不同，这里要注意两次访问是相互配合的，没有第一次的消息查询，也就不会有第二次的数据返回回调。</p>
</blockquote>
<p><strong>4、小结</strong></p>
<p>通过url拦截方式，注入一个本地js文件，来桥接native和web，屏蔽了一些通性工作，在使用上方式相同，好理解，通过两次来回调用实现了可回调function。</p>
<p>github 上也有很多类似的方案，这里就不一一分析了，如果你不是看的这个库，建议好好看看，挺巧妙的机制。</p>
<p>这块逻辑也是看了好久，挺绕的，可以结合打log和debug来分析。</p>
<h5>三：<a href="https://link.jianshu.com/?t=https://github.com/wendux/DSBridge-Android" target="_blank" rel="nofollow">DSBridge-Android</a>
</h5>
<p><strong>1、使用方法</strong></p>
<blockquote>
<p>注意Android 和 Web 使用方式</p>
</blockquote>
<pre class="hljs javascript"><code class="javascript">    webView.callHandler(<span class="hljs-string">"addValue"</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>[]{<span class="hljs-number">1</span>,<span class="hljs-string">"hello"</span>},<span class="hljs-keyword">new</span> CallBackFunction(){
        @Override
        public <span class="hljs-keyword">void</span> onCallBack(<span class="hljs-built_in">String</span> retValue) {
            Log.d(<span class="hljs-string">"jsbridge"</span>,<span class="hljs-string">"call succeed,return value is "</span>+retValue);
        }
    });
   webView.callHandler(<span class="hljs-string">"test"</span>,<span class="hljs-literal">null</span>);

   dsBridge.call(<span class="hljs-string">"testNever"</span>, {<span class="hljs-attr">msg</span>: <span class="hljs-string">"testSyn"</span>});

   dsBridge.call(<span class="hljs-string">"testNoArgAsyn"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) </span>{
       alert(v);
   });
</code></pre>
<p><strong>2、关键类作用：</strong></p>
<ul>
<li>DWebView:WebView的子类，提供了注册、调用 Handler等方法，之后都是通过 webview.callHandler()方式调用js.</li>
<li>CompletionHandler:作为native与web交互的通道，异步回调的关键操作类。</li>
<li>OnReturnValue:js 回调 android的接口，根据 handlerMap 储存的id作为 handler 标示即OnReturnValue实现类。</li>
<li>JsApi:需要注册到 Js java 类。</li>
</ul>
<p>看完这些主要类的作用，在看流程就清晰了。</p>
<p><strong>3、实现原理：</strong></p>
<blockquote>
<p>本质还是使用的系统默认 addJavascriptInterface 方式，其中做了扩展。</p>
</blockquote>
<p>首先需要将这段js注入到 Web 页面</p>
<pre class="hljs javascript"><code class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getJsBridge</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">window</span>._dsf = <span class="hljs-built_in">window</span>._dsf || {};
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">call</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a, c</span>) </span>{
            <span class="hljs-string">"function"</span> == <span class="hljs-keyword">typeof</span> a &amp;&amp; (c = a, a = {});
            <span class="hljs-keyword">if</span> (<span class="hljs-string">"function"</span> == <span class="hljs-keyword">typeof</span> c) {
                <span class="hljs-built_in">window</span>.dscb = <span class="hljs-built_in">window</span>.dscb || <span class="hljs-number">0</span>;
                <span class="hljs-keyword">var</span> d = <span class="hljs-string">"dscb"</span> + <span class="hljs-built_in">window</span>.dscb++;
                <span class="hljs-built_in">window</span>[d] = c;
                a._dscbstub = d
            }
            a = <span class="hljs-built_in">JSON</span>.stringify(a || {});
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>._dswk ? prompt(<span class="hljs-built_in">window</span>._dswk + b, a) : <span class="hljs-string">"function"</span> == <span class="hljs-keyword">typeof</span> _dsbridge ? _dsbridge(b, a) : _dsbridge.call(b, a)
        },
        <span class="hljs-attr">register</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, a</span>) </span>{
            <span class="hljs-string">"object"</span> == <span class="hljs-keyword">typeof</span> b ? <span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">window</span>._dsf, b) : <span class="hljs-built_in">window</span>._dsf[b] = a
        }
    }
}

dsBridge = getJsBridge();
</code></pre>
<p>native -&gt; js：</p>
<p>1、webview.callHandler(method,args,handler)；<br>
2、拼接Js，并生成唯一的callID，将 handler保存到map中；<br>
3、执行js，同时回调 java returnValue()，然后回调使用者调用。</p>
<p>js -&gt; android:</p>
<p>1、dsBridge.call(method,json,function)-&gt; native call(methodName,args)；<br>
2、通过反射来查找methodName对应的方法，并注册 CompletionHandler；<br>
3、JsApi 通过 handler.complete() 方法，并拼装js方法和参数，再次调用js函数实现回调操作，并删除上一次的 callback id。</p>
<p><strong>4、小结：</strong></p>
<p>这个方案比较简单，使用了系统的注入方式，虽然 4.2以下存在漏洞，但是它里面只能反射包含 @JavascriptInterface 注解的方法，所以和4.2以上注入是一样的，也是安全的。</p>
<p>相对案例一，案例二实现方式比较简单粗暴，也比较容易懂。</p>
<p>不过这个库在我的 4.2 设备上有 bug，下面函数执行时找不到 dsBridge 对象，导致 Native 调用 Js 失败。</p>
<pre class="hljs javascript"><code class="javascript"> dsBridge.register(<span class="hljs-string">'addValue'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">l,r</span>)</span>{
     <span class="hljs-keyword">return</span> l+r;
 })
</code></pre>
<p>可能和内核执行有关系，我这做了修复，放到 function 函数中执行就可以了，如果你也遇到，可以参考我的修复方法 <a href="https://link.jianshu.com/?t=https://github.com/whiskeyfei/DSBridge-Android" target="_blank" rel="nofollow">DSBridge-Android</a></p>
<hr>
<h3>九、WebView 缓存原理分析和应用</h3>
<p>这部分内容可以参考这两篇博文:</p>
<ul>
<li><a href="https://link.jianshu.com/?t=http://unclechen.github.io/2017/05/13/WebView%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%92%8C%E5%BA%94%E7%94%A8/" target="_blank" rel="nofollow">WebView缓存原理分析和应用</a></li>
<li><a href="https://link.jianshu.com/?t=http://dev.qq.com/topic/591d537a5bf956911a014c63" target="_blank" rel="nofollow">H5 缓存机制浅析 移动端 Web 加载性能优化</a></li>
</ul>
<p>写的已经很清楚了，我这里就不赘述了。</p>
<p>主要包含一下内容：</p>
<p>1、WebView 的5中缓存类型，以及每个缓存类型工作原理、相同点和不同点、。<br>
2、缓存在手机上的存储。<br>
3、每种缓存机制案例。</p>
<p>如果你想通过过滤来减缓 WebView 请求网络，可以参考 <a href="https://link.jianshu.com/?t=https://github.com/douban/rexxar-android" target="_blank" rel="nofollow">rexxar-android</a> 中关于拦截url操作读取本地操作。</p>
<hr>
<h3>十、性能、体验分析与优化</h3>
<p>参考美团：<a href="https://link.jianshu.com/?t=https://tech.meituan.com/WebViewPerf.html" target="_blank" rel="nofollow">WebView性能、体验分析与优化</a></p>
<p>这部分美团的技术博客已经写的很好了，不仅从性能、内存消耗、体验、安全几个维度，来系统的分析客户端默认 WebView 的问题，还给出了对应的优化方案。</p>
<blockquote>
<p>我的感受：文章中也提到了 QQ 的 Hybrid 架构演进，主要的优化方向和内容和下面的Hybrid 开源框架 <a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic" target="_blank" rel="nofollow">VasSonic</a> 基本一直，当然都是腾讯东东，应该是有所借鉴的。而且关于 WebView 的优化也就是那几部分，串行该并行、缓存 WebView、客户端代替 WebView 网络请求，WebView 拦截url加载本地资源，还有Web 端(cdn 神马的，哈哈，不太熟悉)等等几个主要方面，但是能将上数几个方面都完美的结合到一起的市面上很少，<a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic" target="_blank" rel="nofollow">VasSonic</a>就做到了。</p>
</blockquote>
<h3>十一、Hybrid 开源框架</h3>
<h5>1、<a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic" target="_blank" rel="nofollow">VasSonic</a>
</h5>
<p><a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic" target="_blank" rel="nofollow">VasSonic</a> 是腾讯出品的一个轻量级的高性能的Hybrid框架，专注于提升页面首屏加载速度，完美支持静态直出页面和动态直出页面，兼容离线包等方案。</p>
<blockquote>
<p>我的感受：比豆瓣的框架复杂很多，不是一个量级的，可能和业务也相关吧，毕竟鹅厂用户很多服务也很多啊。我也是断断续续看了很久，逻辑还是挺复杂的，不过思路挺清晰，就是能利用上的资源统统要利用，不能让 CPU 或者网络空等，主要是在WebView 和加载之间做一个完美的桥接，让内容不管在什么情况下都能衔接自如。不过，其中并不包含 JsBridge 部分内容。</p>
</blockquote>
<blockquote>
<p><a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic/wiki" target="_blank" rel="nofollow">VasSonic/wiki</a> wiki 写的也特别清楚，值得好好去研究，另外这个库的QQ群也特别活跃，里面有负责维护的同学帮忙解答疑问，值得点赞！</p>
</blockquote>
<p>辛辛苦苦开源了，作为平时想提高 WebView 访问速度的朋友肯定不会错过这么好的内容，强烈建议大家去阅读源码，库更新也很快。</p>
<h5>2、<a href="https://link.jianshu.com/?t=https://github.com/douban/rexxar-android" target="_blank" rel="nofollow">rexxar-android</a>
</h5>
<p>rexxar-android 是豆瓣的混合开发框架，包含 Web、iOS、Android 三端，Android 部分主要内容围绕路由表、容器、缓存。其他部分可以阅读<a href="https://link.jianshu.com/?t=http://lincode.github.io/Rexxar-OpenSource" target="_blank" rel="nofollow">豆瓣的混合开发框架 -- Rexxar</a> 更详细介绍。</p>
<blockquote>
<p>我的感觉：rexxar-android 在缓存部分还是值得学习的，缓存 Cache 分为两部分：本地预装、本地 file 缓存。其中将每一个需要 Native 完成的功能抽象成一个 widget ，通过制定url协议，过滤并解析url的携带的参数。</p>
</blockquote>
<p>有兴趣的可以下载源码学习。</p>
<p>Rexxar Android 系列学习其他文章</p>
<ul>
<li><a href="https://www.jianshu.com/p/dbdb9964bfaf" target="_blank">Rexxar Android 系列学习(1) 项目结构</a></li>
<li><a href="https://www.jianshu.com/p/1dbde8596492" target="_blank">Rexxar Android 系列学习(2) 路由协议</a></li>
<li><a href="https://www.jianshu.com/p/fef29edd3112" target="_blank">Rexxar Android 系列学习(3) Native 和 web 交互</a></li>
<li><a href="https://www.jianshu.com/p/d0b35658b99e" target="_blank">Rexxar Android 系列学习(4) 错误处理</a></li>
<li><a href="https://www.jianshu.com/p/047775a01401" target="_blank">Rexxar Android 系列学习(5) 过滤拦截</a></li>
<li><a href="https://www.jianshu.com/p/a89dd82648ff" target="_blank">Rexxar Android 系列学习(6) 缓存机制</a></li>
</ul>
<hr>
<h3>十二、完整dmeo</h3>
<h5><strong><a href="https://link.jianshu.com/?t=https://github.com/whiskeyfei/Android_WebView" target="_blank" rel="nofollow">Android_WebView</a></strong></h5>
<hr>
<h3>十三、参考</h3>
<ul>
<li><a href="https://link.jianshu.com/?t=http://blog.csdn.net/self_study/article/details/54928371" target="_blank" rel="nofollow">http://blog.csdn.net/self_study/article/details/54928371</a></li>
<li><a href="https://link.jianshu.com/?t=http://blog.csdn.net/self_study/article/details/55046348" target="_blank" rel="nofollow">http://blog.csdn.net/self_study/article/details/55046348</a></li>
<li><a href="https://link.jianshu.com/?t=https://tech.youzan.com/jsbridge" target="_blank" rel="nofollow">https://tech.youzan.com/jsbridge</a></li>
<li><a href="https://link.jianshu.com/?t=https://juejin.im/entry/573534f82e958a0069b27646" target="_blank" rel="nofollow">https://juejin.im/entry/573534f82e958a0069b27646</a></li>
<li><a href="https://link.jianshu.com/?t=https://yq.aliyun.com/articles/32559" target="_blank" rel="nofollow">https://yq.aliyun.com/articles/32559</a></li>
<li><a href="https://link.jianshu.com/?t=http://tutorials.jenkov.com/android/android-web-apps-using-android-webview.html#android-web-app-or-android-hybrid-app" target="_blank" rel="nofollow">http://tutorials.jenkov.com/android/android-web-apps-using-android-webview.html#android-web-app-or-android-hybrid-app</a></li>
<li><a href="https://link.jianshu.com/?t=https://jiandanxinli.github.io/2016-08-31.html" target="_blank" rel="nofollow">https://jiandanxinli.github.io/2016-08-31.html</a></li>
<li><a href="https://link.jianshu.com/?t=http://dev.qq.com/topic/591d537a5bf956911a014c63" target="_blank" rel="nofollow">http://dev.qq.com/topic/591d537a5bf956911a014c63</a></li>
<li><a href="https://link.jianshu.com/?t=https://tech.meituan.com/WebViewPerf.html" target="_blank" rel="nofollow">https://tech.meituan.com/WebViewPerf.html</a></li>
<li><a href="https://link.jianshu.com/?t=http://unclechen.github.io/2017/05/13/WebView%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%92%8C%E5%BA%94%E7%94%A8/" target="_blank" rel="nofollow">http://unclechen.github.io/2017/05/13/WebView%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%92%8C%E5%BA%94%E7%94%A8/</a></li>
<li><a href="https://link.jianshu.com/?t=https://github.com/Tencent/VasSonic/wiki" target="_blank" rel="nofollow">https://github.com/Tencent/VasSonic/wiki</a></li>
</ul>
<hr>

          </div>
        </div>
    </div>

    <!-- 如果是付费文章，未购买，则显示购买按钮 -->

    <!-- 连载目录项 -->

    <!-- 如果是付费文章 -->
      <!-- 如果是付费连载，已购买，且作者允许赞赏，则显示付费信息和赞赏 -->
        <div id="free-reward-panel" class="support-author"><p>小礼物走一走，来简书关注我</p> <div class="btn btn-pay">赞赏支持</div> <div class="supporter"><ul class="support-list"></ul> <!----></div> <!----> <!----></div>

      <div class="show-foot">
        <a class="notebook" href="https://www.jianshu.com/nb/1785177">
          <i class="iconfont ic-search-notebook"></i>
          <span>Android</span>
</a>        <div class="copyright" data-toggle="tooltip" data-html="true" data-original-title="转载请联系作者获得授权，并标注“简书作者”。">
          © 著作权归作者所有
        </div>
        <div class="modal-wrap" data-report-note="">
          <a id="report-modal">举报文章</a>
        </div>
      </div>

      <!-- 文章底部作者信息 -->
        <div class="follow-detail">
          <div class="info">
            <a class="avatar" href="https://www.jianshu.com/u/fa272f63280a">
              <img src="./Android WebView 全面干货指南 - 简书_files/2d442a0d8106" alt="96">
</a>            <a class="btn btn-success follow"><i class="iconfont ic-follow"></i><span>关注</span></a>
            <a class="title" href="https://www.jianshu.com/u/fa272f63280a">無名小子的杂货铺</a>
            
              <i class="iconfont ic-man"></i>
          <p>写了 61184 字，被 167 人关注，获得了 346 个喜欢</p></div>
            <div class="signature">北漂一枚
记录学习、生活
http://doraemonyu.me</div>
        </div>

    <div class="meta-bottom">
      <div data-v-6ddd02c6="" class="like"><div data-v-6ddd02c6="" class="btn like-group"><div data-v-6ddd02c6="" class="btn-like"><a data-v-6ddd02c6="">喜欢</a></div> <div data-v-6ddd02c6="" class="modal-wrap"><a data-v-6ddd02c6="">42</a></div></div> <!----></div>
      <div class="share-group">
        <a class="share-circle" data-action="weixin-share" data-toggle="tooltip" data-original-title="分享到微信">
          <i class="iconfont ic-wechat"></i>
        </a>
        <a class="share-circle" data-action="weibo-share" data-toggle="tooltip" href="javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/18978328/weibo/image_c002fe88cc7f.png&#39;, &#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》（ 分享自 @简书 ）&#39;,&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=weibo&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));" data-original-title="分享到微博">
          <i class="iconfont ic-weibo"></i>
        </a>
          <a class="share-circle" data-toggle="tooltip" href="http://cwb.assets.jianshu.io/notes/images/18978328/weibo/image_c002fe88cc7f.png" target="_blank" data-original-title="下载长微博图片">
            <i class="iconfont ic-picture"></i>
          </a>
        <a class="share-circle more-share" tabindex="0" data-toggle="popover" data-placement="top" data-html="true" data-trigger="focus" href="javascript:void(0);" data-content="
          &lt;ul class=&quot;share-list&quot;&gt;
            &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=qzone&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-zone&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到QQ空间&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=twitter&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-twitter&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到Twitter&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://www.facebook.com/dialog/share?app_id=483126645039390&amp;display=popup&amp;href=https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=facebook&#39;,x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-facebook&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到Facebook&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=google_plus&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-google&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到Google+&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=douban&#39;)+&#39;&amp;title=&#39;+e(&#39;Android WebView 全面干货指南&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-douban&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到豆瓣&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        " data-original-title="" title="">更多分享</a>
      </div>
    </div>
      <a id="web-note-ad-1" target="_blank" href="https://www.jianshu.com/apps/download?utm_source=nbc"><img src="./Android WebView 全面干货指南 - 简书_files/web-note-ad-1-10f08e404d3887d2d45a4bc8f1831403.png" alt="Web note ad 1"></a>
    <div id="vue_comment"></div>
  </div>

  <div class="side-tool"><ul><li data-placement="left" data-toggle="tooltip" data-container="body" data-original-title="回到顶部" style="display: none;"><a class="function-button"><i class="iconfont ic-backtop"></i></a></li> <!----> <!----> <li data-placement="left" data-toggle="tooltip" data-container="body" data-original-title="分享文章"><a tabindex="0" role="button" data-toggle="popover" data-placement="left" data-html="true" data-trigger="focus" href="javascript:void(0);" data-content="&lt;ul class=&#39;share-list&#39;&gt;
                &lt;li&gt;&lt;a class=&quot;weixin-share&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-weixin&quot;&gt;&lt;/i&gt;&lt;span&gt;分享到微信&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/18978328/weibo/image_c002fe88cc7f.png&#39;, &#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》（ 分享自 @简书 ）&#39;,&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=weibo&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-weibo&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到微博&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;http://cwb.assets.jianshu.io/notes/images/18978328/weibo/image_c002fe88cc7f.png&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;social-icon-sprite social-icon-picture&quot;&gt;&lt;/i&gt;&lt;span&gt;下载长微博图片&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=qzone&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-zone&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到QQ空间&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=twitter&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 無名小子的杂货铺 的文章《Android WebView 全面干货指南》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-twitter&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到Twitter&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://www.facebook.com/dialog/share?app_id=483126645039390&amp;display=popup&amp;href=https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=facebook&#39;,x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-facebook&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到Facebook&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=google_plus&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-google&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到Google+&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;https://www.jianshu.com/p/fd61e8f4049e?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=douban&#39;)+&#39;&amp;title=&#39;+e(&#39;Android WebView 全面干货指南&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()&quot;&gt;&lt;i class=&#39;social-icon-sprite social-icon-douban&#39;&gt;&lt;/i&gt;&lt;span&gt;分享到豆瓣&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
              &lt;/ul&gt;" data-original-title="" title="" class="function-button"><i class="iconfont ic-share"></i></a> <!----></li> <!----></ul></div>
</div>
<div class="note-bottom">
  <div><div class="main"><div class="title">被以下专题收入，发现更多相似内容</div> <!----> <div class="include-collection"><!----> <a href="https://www.jianshu.com/c/31d827918cd9?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/android.jpg"><div class="name">Android...</div></a><a href="https://www.jianshu.com/c/d1591c322c89?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/android.graphics.Bitmap_15f127c2.jpeg"><div class="name">Android开发</div></a><a href="https://www.jianshu.com/c/3fde3b545a35?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/android.graphics.Bitmap_3d178cba.jpeg"><div class="name">Android知识</div></a><a href="https://www.jianshu.com/c/9a56f7fc508d?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/bg.png"><div class="name">编程知识点</div></a><a href="https://www.jianshu.com/c/38d96caffb2f?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/android.graphics.Bitmap_5be8d38.jpeg"><div class="name">技术干货</div></a><a href="https://www.jianshu.com/c/NEt52a?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/computer_guy.jpg"><div class="name">程序员</div></a><a href="https://www.jianshu.com/c/7d70f1739deb?utm_source=desktop&amp;utm_medium=notes-included-collection" target="_blank" class="item"><img src="./Android WebView 全面干货指南 - 简书_files/android.graphics.Bitmap_20b2233c.jpeg"><div class="name">Android...</div></a> <a class="show-more">
        展开更多
        <i class="iconfont ic-show"></i></a></div></div> <!----> <!----></div>
  <div data-vcomp="recommended-notes" data-note-id="18978328"></div>
  <!-- 相关文章 -->
  <div class="seo-recommended-notes">

        <div class="note ">
                    <a class="title" target="_blank" href="https://www.jianshu.com/p/5ad013eb5364?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">掘金 Android 文章精选合集</a>
          <p class="description">用两张图告诉你，为什么你的 App 会卡顿? - Android - 掘金Cover 有什么料？ 从这篇文章中你能获得这些料： 知道setContentView()之后发生了什么？ ... Android 获取 View 宽高的常用正确方式，避免为零 - 掘金相信有很多朋友...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/5fc9b6410f4f?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/6220dd63-bf1a-40a8-8ccc-e364a5c90f13.png" alt="48">
            </div>
            <span class="name">掘金官方</span>
</a>        </div>

        <div class="note ">
                    <a class="title" target="_blank" href="https://www.jianshu.com/p/dad51f6c9c4d?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">Android - 收藏集  </a>
          <p class="description">用两张图告诉你，为什么你的 App 会卡顿? - Android - 掘金 Cover 有什么料？ 从这篇文章中你能获得这些料： 知道setContentView()之后发生了什么？ ... Android 获取 View 宽高的常用正确方式，避免为零 - 掘金 相信有很多...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/e946d18f163c?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/4-3397163ecdb3855a0a4139c34a695885.jpg" alt="48">
            </div>
            <span class="name">passiontim</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/f1803962c0f1?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/1760285-50e94caafaa9fa26.png" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/f1803962c0f1?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation"> 关于 android Webview</a>
          <p class="description">关于 android Webview 基本使用 加载html四种方式 简单使用 在AndroidManifest.xml中添加网络权限 布局文件 activity_main.xml 使用webview 动态加载，防止放生内存泄漏 MainActivity.java webv...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/7828c04ec9ca?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/1c8c15a7-32da-44a7-92b6-4a8f39513486.jpeg" alt="48">
            </div>
            <span class="name">小面包屑</span>
</a>        </div>

        <div class="note ">
                    <a class="title" target="_blank" href="https://www.jianshu.com/p/ebffa8a61e51?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">WebView·开车指南</a>
          <p class="description">WebView·开车指南 目录 WebView简介 WebView基本使用 WebView常用方法 WebSettings WebViewClient WebChromeClient JavaScript与WebView交互 WebView加载优化 驾照考试 上路 WebV...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/54691338e67f?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/aa75699c-c15a-4c86-b7cc-882dfe6b4859.jpg" alt="48">
            </div>
            <span class="name">小庄66</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/6a7c91f1d804?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/1807787-32b08ccee819c446.jpeg" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/6a7c91f1d804?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">WebView·开车指南</a>
          <p class="description">Tips 由于WebView的用法实在太多，如果您只是想查询某个功能的使用——建议Ctrl+F（Commad+F）在本页面搜索关键字查找。 文章给前半部分大多是方法的介绍，若嫌琐碎可直接拖到最后看代码演示。 Thanks for reading~!٩(♡ε♡ )۶ 前言 喝...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/8da8b5a6ec91?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/fd26375e51c4.jpg" alt="48">
            </div>
            <span class="name">BugDev</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/7fa0a27d7705?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/3134797-f3054e5fcdb6ef33.jpg" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/7fa0a27d7705?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">动漫：日本动漫吃老本？只是回归内需</a>
          <p class="description">本文用于回答问题“日本动漫现在是不是在吃老本儿？” 动漫=动画+漫画，这里只说动画部分，我不觉得日本动画在吃老本，有如下理由 - 卖萌卖肉卖腐是新常态 现在的动漫偏向卖萌卖肉卖腐，按照新旧来说，这也是一个新常态，日本动画在日本经济相对于中国还是很牛逼的时期出过非常多有思想的...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/4dd68e0f41ce?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/ce7795e6-1fa8-403c-8af8-59e38e4c8a60.jpg" alt="48">
            </div>
            <span class="name">开天prpr</span>
</a>        </div>

        <div class="note ">
                    <a class="title" target="_blank" href="https://www.jianshu.com/p/2dfa6eb4e816?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">GeekBand Week1</a>
          <p class="description">Object Based vs Object Oriented 基于对象（Object Based）：单一类的设计。 面向对象（Object Oriented）：多重类的设计，包含了类之间的关系（inheritance, composition, delegation） 类...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/bdb99bfe2978?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/596a7c4e7a9a.jpg" alt="48">
            </div>
            <span class="name">Createwindow</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/9d5a40471ddc?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/7961658-e99f4528c8eb9aa6.png" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/9d5a40471ddc?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">追剧时间</a>
          <p class="description"> 今年貌似没有看过一部完整的新电视剧，看过的新电影也就两三部。而大部分追剧时间呢好像一直用来在看以前看过的，每段时间都想翻一部以前爱看现在依然想再看的电视剧出来看。  昨天在看《那年冬天》，还记得第一次是在安徽频道的凌晨时间档守着看完的，而且还是伴着听起来很蹩脚的中文配音。...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/084a9a6a0274?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/a60e0644-fd09-4e7b-8c0d-564d53921bfc.jpg" alt="48">
            </div>
            <span class="name">冬冬妮</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/585b5106c3fc?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/2656044-0e91103240c4eb42.jpg" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/585b5106c3fc?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">20160911 Daily Review</a>
          <p class="description">8:30-9:30 醒过来 照例看看感兴趣的新动态，「保时捷电动跑车问世，处处都是黑科技！」（微型电动车），全篇说了说保时捷概念车除了电动以外带来的“新”科技「眼动追踪」、「手势追踪」、「取消后视镜」、「全轮转向」。只有一项是与电动车有关的，800V充电接口，15min充电...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/d63eb0d2480e?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/98b908fa1963" alt="48">
            </div>
            <span class="name">黄桃de夏天</span>
</a>        </div>

        <div class="note have-img">
          <a class="cover" target="_blank" href="https://www.jianshu.com/p/ee88dac16464?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <img src="./Android WebView 全面干货指南 - 简书_files/927981-adb5b8ae4f0f5f47.jpg" alt="240">
</a>          <a class="title" target="_blank" href="https://www.jianshu.com/p/ee88dac16464?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">那些不存在的</a>
          <p class="description">再次和妹妹回到这片故园，差点悲伤得一句话也说不出来。 秋天的杂草藤蔓生机勃勃得无比陌生，记忆也变得陌生含糊，终于融化在池塘的菏萍竞乱中，几乎荡然无存。 抬头看见一颗死树，我亦不记得这树。 枯木已死，身形犹在。 总还会有什么还在吧 在这废园之中 --- 上午外婆忽然说到开封。...</p>
          <a class="author" target="_blank" href="https://www.jianshu.com/u/6c9f50c3fe28?utm_campaign=maleskine&amp;utm_content=user&amp;utm_medium=seo_notes&amp;utm_source=recommendation">
            <div class="avatar">
              <img src="./Android WebView 全面干货指南 - 简书_files/eebad7ef-2467-450f-997e-77445968c5b1.jpg" alt="48">
            </div>
            <span class="name">狂风落尽深红色绿树成荫子满枝</span>
</a>        </div>
  </div>
</div>

    <script type="application/json" data-name="page-data">{"user_signed_in":false,"locale":"zh-CN","os":"mac","read_mode":"day","read_font":"font2","note_show":{"is_martin_user":false,"is_author":false,"is_following_author":false,"is_liked_note":false,"follow_state":0,"uuid":"7fa20e9f-0f44-4ed2-8db0-6f74635ef8ed"},"note":{"id":18978328,"slug":"fd61e8f4049e","user_id":877678,"notebook_id":1785177,"commentable":true,"likes_count":42,"views_count":2026,"public_wordage":7255,"comments_count":7,"total_rewards_count":0,"is_author":false,"paid_type":"free","paid_content_accessible":false,"author":{"nickname":"無名小子的杂货铺","total_wordage":61184,"followers_count":167,"total_likes_count":346}}}</script>
    
    <script src="./Android WebView 全面干货指南 - 简书_files/babel-polyfill-b99072e62e23ea801bb9.js" crossorigin="anonymous"></script>
    <script src="./Android WebView 全面干货指南 - 简书_files/web-base-e509aa3e52f02e1eb32d.js" crossorigin="anonymous"></script>
<script src="./Android WebView 全面干货指南 - 简书_files/web-3e5c558c184cbb9a2fdf.js" crossorigin="anonymous"></script>
    
    <script src="./Android WebView 全面干货指南 - 简书_files/entry-d25a5518a0d2551d70c1.js" crossorigin="anonymous"></script>
    <script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
</script>

  

<!----><!----></body></html>